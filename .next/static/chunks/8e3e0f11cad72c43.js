(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={assign:function(){return l},searchParamsToUrlQuery:function(){return i},urlQueryToSearchParams:function(){return o}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});function i(e){let t={};for(let[r,n]of e.entries()){let e=t[r];void 0===e?t[r]=n:Array.isArray(e)?e.push(n):t[r]=[e,n]}return t}function a(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function o(e){let t=new URLSearchParams;for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,a(e));else t.set(r,a(n));return t}function l(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,n]of r.entries())e.append(t,n)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={formatUrl:function(){return o},formatWithValidation:function(){return c},urlObjectKeys:function(){return l}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let i=e.r(90809)._(e.r(98183)),a=/https?|ftp|gopher|file/;function o(e){let{auth:t,hostname:r}=e,n=e.protocol||"",s=e.pathname||"",o=e.hash||"",l=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),l&&"object"==typeof l&&(l=String(i.urlQueryToSearchParams(l)));let u=e.search||l&&`?${l}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||a.test(n))&&!1!==c?(c="//"+(c||""),s&&"/"!==s[0]&&(s="/"+s)):c||(c=""),o&&"#"!==o[0]&&(o="#"+o),u&&"?"!==u[0]&&(u="?"+u),s=s.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${n}${c}${s}${u}${o}`}let l=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return o(e)}},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return s}});let n=e.r(71645);function s(e,t){let r=(0,n.useRef)(null),s=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=s.current;t&&(s.current=null,t())}else e&&(r.current=i(e,n)),t&&(s.current=i(t,n))},[e,t])}function i(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DecodeError:function(){return v},MiddlewareNotFoundError:function(){return j},MissingStaticPage:function(){return b},NormalizeError:function(){return g},PageNotFoundError:function(){return x},SP:function(){return m},ST:function(){return y},WEB_VITALS:function(){return i},execOnce:function(){return a},getDisplayName:function(){return d},getLocationOrigin:function(){return c},getURL:function(){return u},isAbsoluteUrl:function(){return l},isResSent:function(){return f},loadGetInitialProps:function(){return p},normalizeRepeatedSlashes:function(){return h},stringifyError:function(){return S}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let i=["CLS","FCP","FID","INP","LCP","TTFB"];function a(e){let t,r=!1;return(...n)=>(r||(r=!0,t=e(...n)),t)}let o=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,l=e=>o.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function u(){let{href:e}=window.location,t=c();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function f(e){return e.finished||e.headersSent}function h(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function p(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await p(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&f(r))return n;if(!n)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let m="undefined"!=typeof performance,y=m&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class v extends Error{}class g extends Error{}class x extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class b extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class j extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function S(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return i}});let n=e.r(18967),s=e.r(52817);function i(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,s.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return v},useLinkStatus:function(){return x}};for(var s in n)Object.defineProperty(r,s,{enumerable:!0,get:n[s]});let i=e.r(90809),a=e.r(43476),o=i._(e.r(71645)),l=e.r(95057),c=e.r(8372),u=e.r(18581),d=e.r(18967),f=e.r(5550);e.r(33525);let h=e.r(91949),p=e.r(73668),m=e.r(9396);function y(e){return"string"==typeof e?e:(0,l.formatUrl)(e)}function v(t){var r;let n,s,i,[l,v]=(0,o.useOptimistic)(h.IDLE_LINK_STATUS),x=(0,o.useRef)(null),{href:b,as:j,children:S,prefetch:w=null,passHref:_,replace:k,shallow:N,scroll:C,onClick:P,onMouseEnter:R,onTouchStart:E,legacyBehavior:A=!1,onNavigate:O,ref:T,unstable_dynamicOnHover:z,...F}=t;n=S,A&&("string"==typeof n||"number"==typeof n)&&(n=(0,a.jsx)("a",{children:n}));let M=o.default.useContext(c.AppRouterContext),I=!1!==w,L=!1!==w?null===(r=w)||"auto"===r?m.FetchStrategy.PPR:m.FetchStrategy.Full:m.FetchStrategy.PPR,{href:U,as:D}=o.default.useMemo(()=>{let e=y(b);return{href:e,as:j?y(j):e}},[b,j]);if(A){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});s=o.default.Children.only(n)}let $=A?s&&"object"==typeof s&&s.ref:T,q=o.default.useCallback(e=>(null!==M&&(x.current=(0,h.mountLinkInstance)(e,U,M,L,I,v)),()=>{x.current&&((0,h.unmountLinkForCurrentNavigation)(x.current),x.current=null),(0,h.unmountPrefetchableInstance)(e)}),[I,U,M,L,v]),B={ref:(0,u.useMergedRef)(q,$),onClick(t){A||"function"!=typeof P||P(t),A&&s.props&&"function"==typeof s.props.onClick&&s.props.onClick(t),!M||t.defaultPrevented||function(t,r,n,s,i,a,l){if("undefined"!=typeof window){let c,{nodeName:u}=t.currentTarget;if("A"===u.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,p.isLocalURL)(r)){i&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),l){let e=!1;if(l({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(99781);o.default.startTransition(()=>{d(n||r,i?"replace":"push",a??!0,s.current)})}}(t,U,D,x,k,C,O)},onMouseEnter(e){A||"function"!=typeof R||R(e),A&&s.props&&"function"==typeof s.props.onMouseEnter&&s.props.onMouseEnter(e),M&&I&&(0,h.onNavigationIntent)(e.currentTarget,!0===z)},onTouchStart:function(e){A||"function"!=typeof E||E(e),A&&s.props&&"function"==typeof s.props.onTouchStart&&s.props.onTouchStart(e),M&&I&&(0,h.onNavigationIntent)(e.currentTarget,!0===z)}};return(0,d.isAbsoluteUrl)(D)?B.href=D:A&&!_&&("a"!==s.type||"href"in s.props)||(B.href=(0,f.addBasePath)(D)),i=A?o.default.cloneElement(s,B):(0,a.jsx)("a",{...F,...B,children:n}),(0,a.jsx)(g.Provider,{value:l,children:i})}e.r(84508);let g=(0,o.createContext)(h.IDLE_LINK_STATUS),x=()=>(0,o.useContext)(g);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},86079,e=>{"use strict";var t=e.i(43476),r=e.i(27260);function n(){return(0,t.jsx)("div",{className:"relative w-full h-96 flex flex-col items-center justify-center text-center overflow-hidden rounded-2xl bg-black/50 p-4",children:(0,t.jsxs)("div",{className:"relative z-10 flex flex-col items-center justify-center",children:[(0,t.jsx)(r.FlixTrendLogo,{size:80}),(0,t.jsx)("h1",{className:"text-3xl font-headline text-accent-cyan font-bold mt-4 animate-glow",children:"FlixTrend"}),(0,t.jsx)("p",{className:"mt-4 text-sm text-gray-400 max-w-sm animate-pulse",children:"Loading the latest vibes from across the universe..."})]})})}e.s(["VibeSpaceLoader",()=>n])},9375,e=>{"use strict";e.i(51718);var t=e.i(18357),r=e.i(71645),n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},s=function(e){return{loading:null==e,value:e}},i=function(e){var t=e?e():void 0,i=(0,r.useReducer)(function(e,t){switch(t.type){case"error":return n(n({},e),{error:t.error,loading:!1,value:void 0});case"reset":return s(t.defaultValue);case"value":return n(n({},e),{error:void 0,loading:!1,value:t.value});default:return e}},s(t)),a=i[0],o=i[1],l=(0,r.useCallback)(function(){o({type:"reset",defaultValue:e?e():void 0})},[e]),c=(0,r.useCallback)(function(e){o({type:"error",error:e})},[]),u=(0,r.useCallback)(function(e){o({type:"value",value:e})},[]);return(0,r.useMemo)(function(){return{error:a.error,loading:a.loading,reset:l,setError:c,setValue:u,value:a.value}},[a.error,a.loading,l,c,u,a.value])},a=function(e,n){var s=i(function(){return e.currentUser}),a=s.error,o=s.loading,l=s.setError,c=s.setValue,u=s.value;return(0,r.useEffect)(function(){var r=(0,t.onAuthStateChanged)(e,function(e){var t,r,s,i;return t=void 0,r=void 0,s=void 0,i=function(){return function(e,t){var r,n,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){var l=[i,o];if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(t){switch(t.label){case 0:if(!(null==n?void 0:n.onUserChanged))return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.onUserChanged(e)];case 2:return t.sent(),[3,4];case 3:return l(t.sent()),[3,4];case 4:return c(e),[2]}})},new(s||(s=Promise))(function(e,n){function a(e){try{l(i.next(e))}catch(e){n(e)}}function o(e){try{l(i.throw(e))}catch(e){n(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof s?r:new s(function(e){e(r)})).then(a,o)}l((i=i.apply(t,r||[])).next())})},l);return function(){r()}},[e]),[u,o,a]};e.s(["useAuthState",()=>a])},55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},94983,e=>{"use strict";let t=(0,e.i(75254).default)("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]);e.s(["MessageCircle",()=>t],94983)},70273,e=>{"use strict";let t=(0,e.i(75254).default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);e.s(["Star",()=>t],70273)},54789,e=>{"use strict";var t=e.i(43476),r=e.i(71645);let n="https://res.cloudinary.com/drrzvi2jp",s=r.default.forwardRef(({src:e,thumbnailUrl:r,className:s,preload:i,loop:a,muted:o,...l},c)=>{let u;if(!e.startsWith(n))return(0,t.jsx)("video",{ref:c,src:e,poster:r,className:s,preload:i||"metadata",loop:a,muted:o,...l});let d=(u=e.match(/https?:\/\/res\.cloudinary\.com\/[a-z0-9-]+\/(image|video|raw)\/upload\/(?:v[0-9]+\/)?([a-zA-Z0-9\/_-]+\.[a-zA-Z0-9]+)/))?u[2]:null;if(!d)return(0,t.jsx)("video",{ref:c,src:e,poster:r,className:s,preload:i||"metadata",loop:a,muted:o,...l});let f=`${n}/video/upload/f_auto,q_auto,w_800,c_limit/${d}`;return(0,t.jsx)("video",{ref:c,src:f,poster:r,className:s,preload:i||"metadata",loop:a,muted:o,...l})});s.displayName="OptimizedVideo",e.s(["OptimizedVideo",0,s])},61911,e=>{"use strict";let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);e.s(["Users",()=>t],61911)},14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},90597,e=>{"use strict";let t=(0,e.i(75254).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);e.s(["Heart",()=>t],90597)},58472,e=>{"use strict";let t=(0,e.i(75254).default)("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]);e.s(["Code",()=>t],58472)},31245,e=>{"use strict";let t=(0,e.i(75254).default)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);e.s(["Bot",()=>t],31245)},90883,40160,18480,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(36180);var n=e.i(98925),s=e.i(2008),i=e.i(70273),a=e.i(55248),o=e.i(94983),l=e.i(71930);let c=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>c],40160);var u=e.i(61059),d=e.i(37505),f=e.i(46932),h=e.i(14764),p=e.i(55436),m=e.i(61911),y=e.i(31245);let v=(0,n.getFirestore)(u.app);function g({post:e,onClose:s}){let[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(""),[g,x]=(0,r.useState)([]),[b,j]=(0,r.useState)(!1),S=u.auth.currentUser;(0,r.useEffect)(()=>{S&&(async()=>{let e=(0,n.query)((0,n.collection)(v,"groups"),(0,n.where)("members","array-contains",S.uid)),t=(await (0,n.getDocs)(e)).docs.map(e=>({...e.data(),id:e.id,isGroup:!0})),r=(0,n.collection)(v,"users",S.uid,"following"),s=(0,n.collection)(v,"users",S.uid,"followers"),[i,o]=await Promise.all([(0,n.getDocs)(r),(0,n.getDocs)(s)]),c=[...new Set([...i.docs.map(e=>e.id),...o.docs.map(e=>e.id)])].map(e=>(0,n.getDocs)((0,n.query)((0,n.collection)(v,"users"),(0,n.where)("uid","==",e)))),u=(await Promise.all(c)).flatMap(e=>e.docs.map(e=>({...e.data(),id:e.id,isGroup:!1})));a([{id:`almighty-chat_${S.uid}`,name:"Almighty",isAlmighty:!0},...t,...u]),l(!1)})()},[S]);let w=async()=>{if(0===g.length||!S)return;j(!0);let t=`Check out this vibe! ${window.location.origin}/post/${e.id}`,r=g.map(r=>{let s=r,a=i.find(e=>e.id===r);return!a||a.isGroup||a.isAlmighty||(s=[S.uid,a.id].sort().join("_")),(0,n.addDoc)((0,n.collection)(v,"chats",s,"messages"),{text:t,sender:S.uid,createdAt:(0,n.serverTimestamp)(),type:"share",sharedPost:e})});await Promise.all(r),j(!1),s()},_=c?i.filter(e=>e.name?.toLowerCase().includes(c.toLowerCase())||e.username?.toLowerCase().includes(c.toLowerCase())):i;return(0,t.jsx)("div",{className:"fixed inset-0 z-[102] flex items-center justify-center bg-black/60 backdrop-blur-sm",onClick:s,children:(0,t.jsxs)(f.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"glass-card p-4 w-full max-w-md relative flex flex-col max-h-[80vh]",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("h2",{className:"text-xl font-headline font-bold mb-4 text-accent-cyan text-center",children:"Share to Signal"}),(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search chats...",className:"input-glass w-full pl-10",value:c,onChange:e=>d(e.target.value)}),(0,t.jsx)(p.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto mb-4 border-y border-accent-cyan/10 py-2",children:o?(0,t.jsx)("p",{className:"text-center text-gray-400",children:"Loading chats..."}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:_.map(e=>(0,t.jsxs)("div",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors ${g.includes(e.id)?"bg-accent-cyan/20":"hover:bg-accent-cyan/10"}`,onClick:()=>{var t;return t=e.id,void x(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-accent-pink to-accent-cyan flex items-center justify-center text-white font-bold text-lg overflow-hidden shrink-0",children:e.isAlmighty?(0,t.jsx)(y.Bot,{}):e.isGroup?e.avatar_url?(0,t.jsx)("img",{src:e.avatar_url,alt:e.name,className:"w-full h-full object-cover"}):(0,t.jsx)(m.Users,{}):e.avatar_url?(0,t.jsx)("img",{src:e.avatar_url,alt:"avatar",className:"w-full h-full object-cover"}):e?.name?.[0]||e?.username?.[0]||"U"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-bold text-sm truncate",children:e.name||e.username}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:e.isGroup?`${e.members?.length} members`:e.isAlmighty?"AI Assistant":`@${e.username}`})]})]},e.id))})}),(0,t.jsxs)("div",{className:"flex gap-2 mt-auto",children:[(0,t.jsx)("button",{className:"btn-glass flex-1",onClick:s,children:"Cancel"}),(0,t.jsxs)("button",{className:"btn-glass bg-accent-cyan text-black flex-1 flex items-center justify-center gap-2",onClick:w,disabled:b||0===g.length,children:[b?"Sending...":`Send to ${g.length} chat(s)`," ",(0,t.jsx)(h.Send,{size:16})]})]})]})})}let x=(0,n.getFirestore)(u.app);function b({post:e,onClose:s}){let[i,a]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),m=u.auth.currentUser;(0,r.useEffect)(()=>{if(!m)return;let e=(0,n.query)((0,n.collection)(x,"collections"),(0,n.where)("ownerId","==",m.uid)),t=(0,n.onSnapshot)(e,e=>{a(e.docs.map(e=>({id:e.id,...e.data()}))),l(!1)});return()=>t()},[m]);let y=async()=>{h.trim()&&m&&(await (0,n.addDoc)((0,n.collection)(x,"collections"),{name:h,ownerId:m.uid,createdAt:(0,n.serverTimestamp)(),postIds:[e.id]}),p(""),d(!1),s())},v=async t=>{let r=(0,n.doc)(x,"collections",t);await (0,n.updateDoc)(r,{postIds:(0,n.arrayUnion)(e.id)}),s()};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,t.jsxs)(f.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"glass-card p-6 w-full max-w-md relative flex flex-col max-h-[80vh]",children:[(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"Ã—"}),(0,t.jsx)("h2",{className:"text-xl font-headline font-bold mb-4 text-accent-cyan",children:"Save to Collection"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto mb-4 border-y border-accent-cyan/10 py-2",children:o?(0,t.jsx)("p",{className:"text-center text-gray-400",children:"Loading collections..."}):(0,t.jsx)("div",{className:"flex flex-col gap-2",children:i.map(e=>(0,t.jsx)("button",{onClick:()=>v(e.id),className:"text-left p-3 rounded-lg hover:bg-accent-cyan/10 w-full",children:e.name},e.id))})}),c?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",placeholder:"New collection name...",value:h,onChange:e=>p(e.target.value),className:"input-glass flex-1"}),(0,t.jsx)("button",{onClick:y,className:"btn-glass bg-accent-pink",children:"Create"})]}):(0,t.jsx)("button",{className:"btn-glass bg-accent-cyan/50 text-white",onClick:()=>d(!0),children:"Create New Collection"})]})})}let j="downloadedPosts",S=null;function w(){return new Promise((e,t)=>{if(S)return e(S);let r=indexedDB.open("FlixTrendDB",1);r.onerror=e=>{console.error("IndexedDB error:",r.error),t("IndexedDB error")},r.onsuccess=t=>{e(S=r.result)},r.onupgradeneeded=e=>{let t=r.result;t.objectStoreNames.contains(j)||t.createObjectStore(j,{keyPath:"id"})}})}async function _(e){let t=await w();return new Promise((r,n)=>{let s=t.transaction(j,"readwrite").objectStore(j).put({...e,downloadedAt:new Date});s.onsuccess=()=>r(),s.onerror=()=>n(s.error)})}async function k(){let e=await w();return new Promise((t,r)=>{let n=e.transaction(j,"readonly").objectStore(j).getAll();n.onsuccess=()=>{t(n.result.sort((e,t)=>t.downloadedAt-e.downloadedAt))},n.onerror=()=>r(n.error)})}async function N(e){let t=await w();return new Promise((r,n)=>{let s=t.transaction(j,"readwrite").objectStore(j).delete(e);s.onsuccess=()=>r(),s.onerror=()=>n(s.error)})}async function C(e){let t=await w();return new Promise((r,n)=>{let s=t.transaction(j,"readonly").objectStore(j).get(e);s.onsuccess=()=>{r(!!s.result)},s.onerror=()=>n(s.error)})}e.s(["getDownloadedPosts",()=>k,"isPostDownloaded",()=>C,"removeDownloadedPost",()=>N,"savePostForOffline",()=>_],18480);var P=e.i(75157);class R extends Error{context;constructor(e){super(`FirestoreError: Missing or insufficient permissions: The following request was denied by Firestore Security Rules:
{
  "operation": "${e.operation}",
  "path": "${e.path}"
  ${e.requestResourceData?`,"requestData": ${JSON.stringify(e.requestResourceData,null,2)}`:""}
}`),this.name="FirestorePermissionError",this.context=e}}var E=e.i(57094);let A=(0,n.getFirestore)(u.app);function O({post:e,onCommentClick:f,isShortVibe:h=!1}){let[p,m]=r.default.useState(0),[y,v]=r.default.useState(!1),[x,j]=r.default.useState(0),[S,w]=r.default.useState(!1),[k,O]=r.default.useState(0),[T,z]=r.default.useState(!1),[F,M]=r.default.useState(!1),[I,L]=r.default.useState(!1),[U,D]=r.default.useState(!1),$=u.auth.currentUser;r.default.useEffect(()=>{if(!e.id)return;let t=(0,n.doc)(A,"posts",e.id),r=(0,n.onSnapshot)(t,e=>{let t=e.data();if(t&&t.likes){let e=t.likes;m(Object.values(e).filter(e=>!0===e).length),$&&v(!!e[$.uid])}else m(0),v(!1)}),s=(0,n.onSnapshot)((0,n.collection)(A,"posts",e.id,"relays"),e=>j(e.size)),i=(0,n.onSnapshot)((0,n.collection)(A,"posts",e.id,"comments"),e=>O(e.size));return C(e.id).then(D),()=>{r(),s(),i()}},[e.id,$]);let q=async t=>{if(t.stopPropagation(),!$)return;let r=(0,n.doc)(A,"posts",e.id),s=$.uid,i={[`likes.${s}`]:!y};if(v(!y),m(e=>y?e-1:e+1),(0,n.updateDoc)(r,i).catch(async e=>{v(y),m(e=>y?e+1:e-1);let t=new R({path:r.path,operation:"update",requestResourceData:i});E.errorEmitter.emit("permission-error",t)}),!y&&e.userId!==$.uid){let t=(0,n.collection)(A,"users",e.userId,"notifications"),r={type:"like",fromUserId:$.uid,fromUsername:$.displayName,fromAvatarUrl:$.photoURL,postId:e.id,postContent:e.content?.substring(0,50)||"your post",createdAt:(0,n.serverTimestamp)(),read:!1};(0,n.addDoc)(t,r).catch(e=>{console.error("Error sending notification:",e);let n=new R({path:t.path,operation:"create",requestResourceData:r});E.errorEmitter.emit("permission-error",n)})}},B=async t=>{t.stopPropagation(),$&&(0,n.runTransaction)(A,async t=>{let r=(0,n.doc)(A,"users",$.uid,"relayedPosts",e.id),s=(0,n.doc)(A,"posts",e.id,"relays",$.uid);if((await t.get(r)).exists())return;let i={type:"relay",originalPostId:e.id,originalPost:e,userId:$.uid,username:$.displayName,avatar_url:$.photoURL,createdAt:(0,n.serverTimestamp)(),publishAt:(0,n.serverTimestamp)()};t.set((0,n.doc)((0,n.collection)(A,"posts")),i),t.set(r,{relayedAt:(0,n.serverTimestamp)()}),t.set(s,{userId:$.uid,username:$.displayName,createdAt:(0,n.serverTimestamp)()})}).catch(async t=>{let r=new R({path:e.id,operation:"write",requestResourceData:{relay:!0}});E.errorEmitter.emit("permission-error",r)})},V=async t=>{t.stopPropagation();try{U?(await N(e.id),D(!1)):(await _(e),D(!0))}catch(e){console.error("Offline action failed:",e)}},K=h?"text-white":"text-muted-foreground";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:(0,P.cn)("flex items-center",h?"flex-col gap-4":"justify-between mt-2 pt-2 border-t border-glass-border"),children:[(0,t.jsxs)("div",{className:(0,P.cn)("flex items-center justify-start",h?"flex-col gap-4":"gap-6"),children:[(0,t.jsxs)("button",{className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",K,"hover:text-brand-gold"),onClick:e=>{e.stopPropagation(),f()},children:[(0,t.jsx)(o.MessageCircle,{size:20}),!h&&(0,t.jsx)("span",{children:k})]}),(0,t.jsxs)("button",{className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",S?"text-green-400":K,"hover:text-green-400"),onClick:B,children:[(0,t.jsx)(s.Repeat2,{size:20}),!h&&(0,t.jsx)("span",{children:x})]}),(0,t.jsxs)("button",{"data-like-button":"true",className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",y?"text-yellow-400":K,"hover:text-yellow-400"),onClick:q,children:[(0,t.jsx)(i.Star,{size:20,fill:y?"currentColor":"none"}),!h&&(0,t.jsx)("span",{children:p})]}),(0,t.jsx)("button",{className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",K,"hover:text-accent-cyan"),onClick:e=>{e.stopPropagation(),z(!0)},children:(0,t.jsx)(a.Share,{size:20})})]}),!h&&(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",K,U?"text-blue-400":"hover:text-blue-400"),onClick:V,title:"Save for Offline",children:(0,t.jsx)(c,{size:20})}),(0,t.jsx)("button",{className:(0,P.cn)("flex items-center gap-1.5 font-bold transition-all text-lg",K,"hover:text-accent-purple"),onClick:e=>{e.stopPropagation(),L(!0)},children:(0,t.jsx)(l.Bookmark,{size:20})})]})]}),T&&(0,t.jsx)(d.ShareModal,{url:`${window.location.origin}/post/${e.id}`,title:e.content,isVideo:"media"===e.type&&e.mediaUrl&&(Array.isArray(e.mediaUrl)?e.mediaUrl.some(e=>e.includes(".mp4")):e.mediaUrl.includes(".mp4")),onSignalShare:()=>{z(!1),M(!0)},onClose:()=>z(!1)}),F&&(0,t.jsx)(g,{post:e,onClose:()=>M(!1)}),I&&(0,t.jsx)(b,{post:e,onClose:()=>L(!1)})]})}e.s(["PostActions",()=>O],90883)},16015,(e,t,r)=>{},98547,(e,t,r)=>{var n=e.i(47167);e.r(16015);var s=e.r(71645),i=s&&"object"==typeof s&&"default"in s?s:{default:s},a=void 0!==n.default&&n.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,r=t.name,n=void 0===r?"stylesheet":r,s=t.optimizeForSpeed,i=void 0===s?a:s;c(o(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",c("boolean"==typeof i,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=i,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,r=e.prototype;return r.setOptimizeForSpeed=function(e){c("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),c(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},r.isOptimizeForSpeed=function(){return this._optimizeForSpeed},r.inject=function(){var e=this;if(c(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(a||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,r){return"number"==typeof r?e._serverSheet.cssRules[r]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),r},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},r.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},r.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},r.insertRule=function(e,t){if(c(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var r=this.getSheet();"number"!=typeof t&&(t=r.cssRules.length);try{r.insertRule(e,t)}catch(t){return a||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},r.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var r="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!r.cssRules[e])return e;r.deleteRule(e);try{r.insertRule(t,e)}catch(n){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),r.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];c(n,"old rule at index `"+e+"` not found"),n.textContent=t}return e},r.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];c(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},r.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},r.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,r){return r?t=t.concat(Array.prototype.map.call(e.getSheetForTag(r).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},r.makeStyleTag=function(e,t,r){t&&c(o(t),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),t&&n.appendChild(document.createTextNode(t));var s=document.head||document.getElementsByTagName("head")[0];return r?s.insertBefore(n,r):s.appendChild(n),n},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function c(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return t>>>0},d={};function f(e,t){if(!t)return"jsx-"+e;var r=String(t),n=e+r;return d[n]||(d[n]="jsx-"+u(e+"-"+r)),d[n]}function h(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var r=e+t;return d[r]||(d[r]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[r]}var p=function(){function e(e){var t=void 0===e?{}:e,r=t.styleSheet,n=void 0===r?null:r,s=t.optimizeForSpeed,i=void 0!==s&&s;this._sheet=n||new l({name:"styled-jsx",optimizeForSpeed:i}),this._sheet.inject(),n&&"boolean"==typeof i&&(this._sheet.setOptimizeForSpeed(i),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var r=this.getIdAndRules(e),n=r.styleId,s=r.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var i=s.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=i,this._instancesCounts[n]=1},t.remove=function(e){var t=this,r=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(r in this._instancesCounts,"styleId: `"+r+"` not found"),this._instancesCounts[r]-=1,this._instancesCounts[r]<1){var n=this._fromServer&&this._fromServer[r];n?(n.parentNode.removeChild(n),delete this._fromServer[r]):(this._indices[r].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[r]),delete this._instancesCounts[r]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],r=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return r[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,r;return t=this.cssRules(),void 0===(r=e)&&(r={}),t.map(function(e){var t=e[0],n=e[1];return i.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:r.nonce?r.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},t.getIdAndRules=function(e){var t=e.children,r=e.dynamic,n=e.id;if(r){var s=f(n,r);return{styleId:s,rules:Array.isArray(t)?t.map(function(e){return h(s,e)}):[h(s,t)]}}return{styleId:f(n),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),m=s.createContext(null);function y(){return new p}function v(){return s.useContext(m)}m.displayName="StyleSheetContext";var g=i.default.useInsertionEffect||i.default.useLayoutEffect,x="undefined"!=typeof window?y():void 0;function b(e){var t=x||v();return t&&("undefined"==typeof window?t.add(e):g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}b.dynamic=function(e){return e.map(function(e){return f(e[0],e[1])}).join(" ")},r.StyleRegistry=function(e){var t=e.registry,r=e.children,n=s.useContext(m),a=s.useState(function(){return n||t||y()})[0];return i.default.createElement(m.Provider,{value:a},r)},r.createStyleRegistry=y,r.style=b,r.useStyleRegistry=v},37902,(e,t,r)=>{t.exports=e.r(98547).style},51479,e=>{"use strict";var t=e.i(43476),r=e.i(37902),n=e.i(71645);e.i(36180);var s=e.i(98925),i=e.i(61059),a=e.i(86079),o=e.i(54789),l=e.i(31343),c=e.i(90597),u=e.i(75254);let d=(0,u.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),f=(0,u.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var h=e.i(95762),p=e.i(90883),m=e.i(22016),y=e.i(11152),v=e.i(46932),g=e.i(88653);let x=(0,s.getFirestore)(i.app);function b({post:e,onNext:r,onPrev:i,onView:a}){let u=(0,n.useRef)(null),b=(0,n.useRef)(null),{setIsScopeVideoPlaying:j}=(0,h.useAppState)(),[S,w]=(0,n.useState)(!1),[_,k]=(0,n.useState)(!1),[N,C]=(0,n.useState)(!1),[P,R]=(0,n.useState)(!1),E=(0,n.useRef)(!1),A=(0,n.useRef)("idle"),O=(0,n.useRef)(null),T=(0,n.useCallback)(()=>{if(E.current||!e.id)return;E.current=!0;let t=(0,s.doc)(x,"posts",e.id);(0,s.updateDoc)(t,{viewCount:(0,s.increment)(1)}).catch(e=>console.error("Error incrementing view count:",e)),a()},[e.id,a]);(0,n.useEffect)(()=>{let e=u.current;if(!e)return;let t=new IntersectionObserver(([t])=>{t.isIntersecting?(e.play().catch(e=>{console.error("Autoplay failed:",e)}),T()):(e.pause(),e&&(e.currentTime=0),A.current="idle")},{threshold:.7});t.observe(e);let r=()=>w(!0),n=()=>w(!1),s=()=>k(e.muted);return e.addEventListener("play",r),e.addEventListener("pause",n),e.addEventListener("volumechange",s),()=>{e&&(t.unobserve(e),e.removeEventListener("play",r),e.removeEventListener("pause",n),e.removeEventListener("volumechange",s)),j(!1)}},[j,T]),(0,n.useEffect)(()=>{j(S)},[S,j]);let z=()=>{u.current&&(u.current.playbackRate=2)},F=()=>{u.current&&(u.current.playbackRate=1)},M=Array.isArray(e.mediaUrl)?e.mediaUrl.find(e=>/\.(mp4|webm|ogg)$/i.test(e)):e.mediaUrl;return(0,t.jsxs)("div",{ref:b,className:"relative w-full h-full bg-black flex items-center justify-center cursor-pointer",onClick:()=>{if(O.current){let e;clearTimeout(O.current),O.current=null,R(!0),setTimeout(()=>R(!1),800),(e=b.current?.querySelector('[data-like-button="true"]'))instanceof HTMLElement&&e.click()}else O.current=setTimeout(()=>{let e;(e=u.current)&&("idle"===A.current?(e.muted=!e.muted,k(e.muted),A.current="muted"):(e.paused?e.play():e.pause(),A.current="idle")),O.current=null},250)},children:[(0,t.jsx)(o.OptimizedVideo,{ref:u,src:M,className:"w-full h-full object-contain",loop:!0,playsInline:!0,muted:_,preload:"metadata",onMouseDown:z,onMouseUp:F,onTouchStart:z,onTouchEnd:F}),(0,t.jsxs)(g.AnimatePresence,{children:[P&&(0,t.jsx)(v.motion.div,{initial:{scale:.5,opacity:0},animate:{scale:1.2,opacity:1},exit:{scale:2,opacity:0},transition:{duration:.4,ease:"easeOut"},className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsx)(c.Heart,{fill:"red",stroke:"white",strokeWidth:2,size:100})},"heart"),!S&&(0,t.jsx)(v.motion.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,t.jsx)(l.Play,{size:80,className:"text-white/70 drop-shadow-lg"})},"play-icon")]}),(0,t.jsxs)("div",{className:"absolute inset-0 w-full h-full p-4 pr-8 flex items-end justify-between pointer-events-none bg-gradient-to-t from-black/60 via-black/20 to-transparent",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-2 self-end text-white drop-shadow-lg max-w-[calc(100%-80px)] pointer-events-auto",children:[(0,t.jsxs)(m.default,{href:`/squad/${e.userId}`,className:"flex items-center gap-2 group cursor-pointer w-fit",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-tr from-accent-pink to-accent-green flex items-center justify-center font-bold text-lg overflow-hidden border-2 border-accent-green group-hover:scale-105 transition-transform",children:e.avatar_url?(0,t.jsx)("img",{src:e.avatar_url,alt:"avatar",className:"w-full h-full object-cover"}):(0,t.jsx)("span",{className:"text-white",children:e.displayName?.[0]||"U"})}),(0,t.jsxs)("span",{className:"font-headline text-white text-base group-hover:underline",children:["@",e.username||"user"]})]}),(0,t.jsx)("p",{className:"text-white text-sm font-body line-clamp-3",children:e.content}),e.song&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-white text-sm",children:[(0,t.jsx)(y.FaMusic,{})," ",(0,t.jsxs)("span",{children:[e.song.name," - ",e.song.artists.join(", ")]})]})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4 self-end pointer-events-auto",children:(0,t.jsx)(p.PostActions,{post:e,isShortVibe:!0,onCommentClick:()=>C(!0)})})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-4 absolute top-1/2 -translate-y-1/2 right-4",children:[(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),i()},className:"p-3 bg-black/40 rounded-full text-white hover:bg-black/70",children:(0,t.jsx)(d,{})}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),r()},className:"p-3 bg-black/40 rounded-full text-white hover:bg-black/70",children:(0,t.jsx)(f,{})})]})]})}var j=e.i(9375);let S=(0,s.getFirestore)(i.app);function w(){let[e,o]=(0,n.useState)([]),[l,c]=(0,n.useState)(!0),{setIsScopeVideoPlaying:u}=(0,h.useAppState)(),[d]=(0,j.useAuthState)(i.auth),[f,p]=(0,n.useState)(null),[m,y]=(0,n.useState)(!0),[v,g]=(0,n.useState)(!1),x=(0,n.useRef)(null),[w,_]=(0,n.useState)(0),k=(0,n.useCallback)(async()=>{let e;if(m&&!v){g(!0),e=f?(0,s.query)((0,s.collection)(S,"posts"),(0,s.where)("isVideo","==",!0),(0,s.orderBy)("publishAt","desc"),(0,s.startAfter)(f),(0,s.limit)(3)):(0,s.query)((0,s.collection)(S,"posts"),(0,s.where)("isVideo","==",!0),(0,s.orderBy)("publishAt","desc"),(0,s.limit)(3));try{let t=await (0,s.getDocs)(e),r=t.docs.map(e=>({id:e.id,...e.data()})),n=t.docs[t.docs.length-1],i=new Set(r.map(e=>e.id));o(e=>[...e.filter(e=>!i.has(e.id)),...r]),p(n),y(3===t.docs.length)}catch(e){console.error("Error fetching more video posts:",e)}finally{g(!1),c(!1)}}},[m,v,f]);(0,n.useEffect)(()=>{d&&0===e.length?k():d||c(!1)},[d,e.length,k]),(0,n.useEffect)(()=>{w>e.length-3&&m&&!v&&k()},[w,e.length,m,v,k]),(0,n.useEffect)(()=>{u(!1)},[u]);let N=e=>{let t=x.current;if(t){let r=t.children[e];r&&r.scrollIntoView({behavior:"smooth",block:"start"})}},C=()=>{let t=Math.min(w+1,e.length-1);_(t),N(t)},P=()=>{let e=Math.max(w-1,0);_(e),N(e)};return l&&0===e.length?(0,t.jsx)(a.VibeSpaceLoader,{}):(0,t.jsxs)("div",{className:"jsx-4c79a481febf8830 w-full h-screen bg-black flex flex-col relative",children:[(0,t.jsx)(r.default,{id:"4c79a481febf8830",children:"body{overflow-y:hidden}main{padding:0!important}"}),(0,t.jsx)("div",{ref:x,onScroll:e=>{let{scrollTop:t,clientHeight:r}=e.currentTarget,n=Math.round(t/r);n!==w&&_(n)},className:"jsx-4c79a481febf8830 absolute inset-0 w-full h-full snap-y snap-mandatory overflow-y-scroll overflow-x-hidden scroll-smooth",children:e.length>0?(0,t.jsxs)(t.Fragment,{children:[e.map(e=>(0,t.jsx)("div",{className:"jsx-4c79a481febf8830 h-screen w-screen snap-start flex items-center justify-center",children:(0,t.jsx)(b,{post:e,onNext:C,onPrev:P,onView:()=>{}})},e.id)),v&&(0,t.jsx)("div",{className:"jsx-4c79a481febf8830 h-screen w-screen snap-start flex items-center justify-center",children:(0,t.jsx)("div",{className:"jsx-4c79a481febf8830 animate-spin rounded-full h-12 w-12 border-b-2 border-accent-cyan"})})]}):(0,t.jsxs)("div",{className:"jsx-4c79a481febf8830 flex flex-col h-full items-center justify-center text-center p-4",children:[(0,t.jsx)("h1",{className:"jsx-4c79a481febf8830 text-3xl font-headline font-bold text-accent-cyan",children:"The Scope is Clear"}),(0,t.jsx)("p",{className:"jsx-4c79a481febf8830 text-gray-400 mt-2",children:"Follow some creators to see their short vibes here!"})]})})]})}e.s(["default",()=>w],51479)}]);