(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55436,e=>{"use strict";let t=(0,e.i(75254).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>t],55436)},20641,e=>{"use strict";var t=e.i(43476),a=e.i(71645);e.i(36180);var l=e.i(98925),s=e.i(61059);let i=(0,l.getFirestore)(s.app),r=({ad:e})=>{if(!e?.creative)return null;let{creative:a}=e;return(0,t.jsxs)("div",{className:"w-full glass-card p-4 my-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-accent-purple overflow-hidden",children:(0,t.jsx)("img",{src:`https://api.dicebear.com/8.x/initials/svg?seed=${e.campaign.name}`,alt:"advertiser logo",className:"w-full h-full"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-bold",children:e.campaign.name}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"Sponsored"})]})]}),"image"===a.type&&a.mediaUrl&&(0,t.jsx)("img",{src:a.mediaUrl,alt:a.headline,className:"rounded-lg w-full"}),"video"===a.type&&a.mediaUrl&&(0,t.jsx)("video",{src:a.mediaUrl,className:"rounded-lg w-full",controls:!0}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("p",{className:"font-bold text-accent-cyan",children:a.headline}),(0,t.jsx)("p",{className:"text-sm text-gray-300",children:a.body}),(0,t.jsxs)("a",{href:a.callToActionUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent-pink hover:underline mt-2 inline-block",children:[a.callToAction," →"]})]})]})};function c(){let[e,s]=(0,a.useState)(null);return((0,a.useEffect)(()=>{(async()=>{try{let e=(0,l.collection)(i,"adCampaigns"),t=(0,l.query)(e,(0,l.where)("status","==","active"),(0,l.limit)(10)),a=await (0,l.getDocs)(t);if(a.empty)return;let r=a.docs.map(e=>({id:e.id,...e.data()})),c=r[Math.floor(Math.random()*r.length)],n=(0,l.collection)(i,"adCampaigns",c.id,"creatives"),o=await (0,l.getDocs)((0,l.query)(n,(0,l.limit)(1)));if(o.empty)return;let d={id:o.docs[0].id,...o.docs[0].data()};s({campaign:c,creative:d})}catch(e){console.error("Error fetching FlixTrend ad:",e)}})()},[]),e)?(0,t.jsx)(r,{ad:e}):null}e.s(["default",()=>c])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},95187,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var l={callServer:function(){return i.callServer},createServerReference:function(){return c.createServerReference},findSourceMapURL:function(){return r.findSourceMapURL}};for(var s in l)Object.defineProperty(a,s,{enumerable:!0,get:l[s]});let i=e.r(32120),r=e.r(92245),c=e.r(35326)},3975,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(46932),s=e.i(88653),i=e.i(37727),r=e.i(20641);function c({onComplete:e}){let[c,n]=(0,a.useState)(5);return(0,a.useEffect)(()=>{if(c<=0)return void e();let t=setTimeout(()=>n(e=>e-1),1e3);return()=>clearTimeout(t)},[c,e]),(0,t.jsx)(s.AnimatePresence,{children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[110] bg-black/80 backdrop-blur-md flex flex-col items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"absolute top-4 right-4 z-10",children:c>0?(0,t.jsxs)("span",{className:"text-white bg-black/50 rounded-full px-3 py-1 text-sm",children:["You can skip in ",c]}):(0,t.jsxs)("button",{onClick:e,className:"text-white bg-black/50 rounded-full px-4 py-2 text-sm flex items-center gap-2",children:["Skip Ad ",(0,t.jsx)(i.X,{size:16})]})}),(0,t.jsx)("div",{className:"w-full max-w-sm",children:(0,t.jsx)(r.default,{})}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Sponsored Message"})]})})}e.s(["default",()=>c])},72128,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(46932),s=e.i(31343),i=e.i(95242),r=e.i(7233),c=e.i(53339),n=e.i(55436);e.i(36180);var o=e.i(98925),d=e.i(61059),u=e.i(95762),m=e.i(3975),x=e.i(95187),p=(0,x.createServerReference)("402d1d5f9b289b58a3181d8bf4499ed3d754b00065",x.callServer,void 0,x.findSourceMapURL,"uploadToCloudinary");let f=(0,o.getFirestore)(d.app);function h({onClose:e}){let[s,i]=(0,a.useState)({title:"",artist:"",album:"",genre:"",year:"",description:""}),[r,c]=(0,a.useState)(null),[n,u]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1),[b,y]=(0,a.useState)(""),j=e=>{i({...s,[e.target.name]:e.target.value})},v=(e,t)=>{if(e.target.files&&e.target.files[0]){let a=e.target.files[0];"art"===t?(c(a),x(URL.createObjectURL(a))):u(a)}},N=async t=>{if(t.preventDefault(),!n||!r||!s.title||!s.artist)return void y("Please fill in all required fields and upload both files.");g(!0),y("");try{let t=d.auth.currentUser;if(!t)throw Error("Not logged in");let a=new FormData;a.append("file",n);let l=await p(a);if(!l.success||!l.url)throw Error("Audio upload failed.");let i=new FormData;i.append("file",r);let c=await p(i);if(!c.success||!c.url)throw Error("Album art upload failed.");await (0,o.addDoc)((0,o.collection)(f,"songs"),{...s,audioUrl:l.url,albumArtUrl:c.url,userId:t.uid,username:t.displayName,createdAt:(0,o.serverTimestamp)()}),e()}catch(e){y(e.message)}g(!1)};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"glass-card p-6 w-full max-w-lg relative max-h-[90vh] flex flex-col",children:[(0,t.jsx)("button",{onClick:e,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"×"}),(0,t.jsx)("h2",{className:"text-xl font-headline font-bold mb-4 text-accent-cyan",children:"Add a New Song"}),(0,t.jsxs)("form",{onSubmit:N,className:"flex flex-col gap-3 overflow-y-auto pr-2",children:[(0,t.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,t.jsx)("div",{className:"w-32 h-32 bg-black/20 rounded-lg flex items-center justify-center text-gray-400 overflow-hidden shrink-0",children:m?(0,t.jsx)("img",{src:m,alt:"preview",className:"w-full h-full object-cover"}):"Album Art"}),(0,t.jsxs)("div",{className:"flex flex-col gap-3 w-full",children:[(0,t.jsx)("input",{type:"text",name:"title",placeholder:"Song Title",className:"input-glass w-full",value:s.title,onChange:j,required:!0}),(0,t.jsx)("input",{type:"text",name:"artist",placeholder:"Artist Name",className:"input-glass w-full",value:s.artist,onChange:j,required:!0})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("input",{type:"text",name:"album",placeholder:"Album Name",className:"input-glass w-full",value:s.album,onChange:j}),(0,t.jsx)("input",{type:"text",name:"genre",placeholder:"Genre",className:"input-glass w-full",value:s.genre,onChange:j}),(0,t.jsx)("input",{type:"number",name:"year",placeholder:"Year",className:"input-glass w-full",value:s.year,onChange:j})]}),(0,t.jsx)("textarea",{name:"description",placeholder:"Describe the song, its vibe, or a story behind it...",className:"input-glass w-full rounded-2xl",rows:4,value:s.description,onChange:j}),(0,t.jsx)("label",{className:"text-sm font-bold text-accent-cyan mt-2",children:"Upload Album Art"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>v(e,"art"),className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent-pink/20 file:text-accent-pink hover:file:bg-accent-pink/40",required:!0}),(0,t.jsx)("label",{className:"text-sm font-bold text-accent-cyan mt-2",children:"Upload Audio File"}),(0,t.jsx)("input",{type:"file",accept:"audio/*",onChange:e=>v(e,"audio"),className:"block w-full text-sm text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-accent-cyan/20 file:text-accent-cyan hover:file:bg-accent-cyan/40",required:!0}),b&&(0,t.jsx)("div",{className:"text-red-400 text-center",children:b}),(0,t.jsx)("button",{type:"submit",className:"btn-glass bg-accent-cyan text-black mt-4",disabled:h,children:h?"Uploading...":"Add Song"})]})]})})}function g({song:e,onClose:s}){let[i,r]=(0,a.useState)([]),[c,n]=(0,a.useState)(!0),[u,m]=(0,a.useState)(!1),[x,p]=(0,a.useState)(""),h=d.auth.currentUser;(0,a.useEffect)(()=>{if(!h)return;let e=(0,o.query)((0,o.collection)(f,"playlists"),(0,o.where)("ownerId","==",h.uid)),t=(0,o.onSnapshot)(e,e=>{r(e.docs.map(e=>({id:e.id,...e.data()}))),n(!1)});return()=>t()},[h]);let g=async()=>{x.trim()&&h&&(await (0,o.addDoc)((0,o.collection)(f,"playlists"),{name:x,ownerId:h.uid,createdAt:(0,o.serverTimestamp)(),songIds:[e.id]}),p(""),m(!1),s())},b=async t=>{let a=(0,o.doc)(f,"playlists",t);await (0,o.updateDoc)(a,{songIds:(0,o.arrayUnion)(e.id)}),s()};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"glass-card p-6 w-full max-w-md relative flex flex-col max-h-[80vh]",children:[(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:"×"}),(0,t.jsx)("h2",{className:"text-xl font-headline font-bold mb-4 text-accent-cyan",children:"Add to Playlist"}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto mb-4 border-y border-accent-cyan/10 py-2",children:c?(0,t.jsx)("p",{className:"text-center text-gray-400",children:"Loading playlists..."}):(0,t.jsx)("div",{className:"flex flex-col gap-2",children:i.map(e=>(0,t.jsx)("button",{onClick:()=>b(e.id),className:"text-left p-3 rounded-lg hover:bg-accent-cyan/10 w-full",children:e.name},e.id))})}),u?(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",placeholder:"New playlist name...",value:x,onChange:e=>p(e.target.value),className:"input-glass flex-1"}),(0,t.jsx)("button",{onClick:g,className:"btn-glass bg-accent-pink",children:"Create"})]}):(0,t.jsx)("button",{className:"btn-glass bg-accent-cyan/50 text-white",onClick:()=>m(!0),children:"Create New Playlist"})]})})}function b(){let[e,d]=(0,a.useState)([]),[x,p]=(0,a.useState)(!0),[b,y]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[N,w]=(0,a.useState)(""),{activeSong:S,isPlaying:k,playSong:C,pauseSong:A}=(0,u.useAppState)(),[U,T]=(0,a.useState)(!1),P=(0,a.useRef)(0),L=(0,a.useRef)(null),R=()=>{L.current&&clearTimeout(L.current),L.current=setTimeout(()=>{T(!0)},12e5)};(0,a.useEffect)(()=>{let e=(0,o.query)((0,o.collection)(f,"songs"),(0,o.orderBy)("createdAt","desc")),t=(0,o.onSnapshot)(e,e=>{d(e.docs.map(e=>({id:e.id,...e.data()}))),p(!1)});return()=>t()},[]);let M=(e,t)=>{S?.id!==e.id&&(P.current+=1,P.current>=3&&(T(!0),P.current=0)),S?.id===e.id&&k?(A(),L.current&&clearTimeout(L.current)):(C(e,z,t),R())},z=N?e.filter(e=>e.title?.toLowerCase().includes(N.toLowerCase())||e.artist?.toLowerCase().includes(N.toLowerCase())||e.album?.toLowerCase().includes(N.toLowerCase())):e;return x?(0,t.jsx)("div",{className:"text-center text-accent-cyan animate-pulse",children:"Loading music library..."}):(0,t.jsxs)("div",{className:"w-full flex flex-col items-center relative",children:[U&&(0,t.jsx)(m.default,{onComplete:()=>{T(!1),R()}}),(0,t.jsx)("h2",{className:"text-3xl font-headline bg-gradient-to-r from-accent-pink to-accent-green bg-clip-text text-transparent mb-6",children:"Community Music"}),(0,t.jsxs)("div",{className:"relative mb-8 w-full max-w-lg mx-auto",children:[(0,t.jsx)("input",{type:"text",className:"input-glass w-full pl-12 pr-4 py-3",placeholder:"Search for songs, artists, albums...",value:N,onChange:e=>w(e.target.value)}),(0,t.jsx)("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-xl text-brand-gold pointer-events-none",children:(0,t.jsx)(n.Search,{})})]}),0===z.length?(0,t.jsxs)("div",{className:"text-center text-gray-400 mt-16",children:[(0,t.jsx)(c.Music,{size:64,className:"mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-bold",children:N?"No Results Found":"The Stage is Empty"}),(0,t.jsx)("p",{children:N?"Try a different search term.":"Be the first to upload a song!"})]}):(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:z.map((e,a)=>(0,t.jsxs)(l.motion.div,{className:"glass-card flex flex-col items-center text-center group",whileHover:{y:-5},children:[(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)("img",{src:e.albumArtUrl,alt:e.title,className:"w-full h-auto rounded-t-2xl aspect-square object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:()=>M(e,a),children:S?.id===e.id&&k?(0,t.jsx)(i.Pause,{size:48,className:"text-white"}):(0,t.jsx)(s.Play,{size:48,className:"text-white"})}),(0,t.jsx)("button",{className:"absolute top-2 right-2 p-2 bg-black/40 rounded-full text-white hover:bg-accent-pink",title:"Add to playlist",onClick:t=>{t.stopPropagation(),v(e)},children:(0,t.jsx)(r.Plus,{size:16})})]}),(0,t.jsxs)("div",{className:"p-4 w-full cursor-pointer",onClick:()=>M(e,a),children:[(0,t.jsx)("h3",{className:"font-headline text-base font-bold mb-1 text-accent-cyan truncate",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-400 truncate",children:e.artist})]})]},e.id))}),(0,t.jsx)("button",{className:"fixed bottom-24 right-4 z-50 btn-glass-icon w-16 h-16 bg-gradient-to-tr from-accent-pink to-accent-purple flex items-center justify-center","aria-label":"Add Song",onClick:()=>y(!0),children:(0,t.jsx)(r.Plus,{size:32})}),b&&(0,t.jsx)(h,{onClose:()=>y(!1)}),j&&(0,t.jsx)(g,{song:j,onClose:()=>v(null)})]})}e.s(["MusicDiscovery",()=>b],72128)},42236,e=>{e.n(e.i(72128))}]);