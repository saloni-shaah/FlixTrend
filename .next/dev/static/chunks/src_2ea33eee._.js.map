{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/utils/firebaseClient.ts"],"sourcesContent":["// src/utils/firebaseClient.ts\nimport { initializeApp, getApps, getApp, type FirebaseApp } from \"firebase/app\";\nimport { getAuth, type Auth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore, type Firestore } from \"firebase/firestore\";\nimport { getStorage, type Storage } from \"firebase/storage\";\nimport { getFunctions, type Functions } from \"firebase/functions\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBP1VyEIjPzt43DJokCj9WhPbTrZXbEVb8\",\n  authDomain: \"flixtrend-24072025.firebaseapp.com\",\n  projectId: \"flixtrend-24072025\",\n  storageBucket: \"flixtrend-24072025.firebasestorage.app\",\n  messagingSenderId: \"200803738308\",\n  appId: \"1:200803738308:web:ed7942db23395b0d101f91\",\n  measurementId: \"G-H48LZPV9QZ\"\n};\n\nconst app = getApps().length ? getApp() : initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\nconst storage = getStorage(app);\nconst functions = getFunctions(app);\n\n// Add this block for local development to bypass reCAPTCHA\nif (typeof window !== 'undefined' && window.location.hostname === \"localhost\") {\n  // Point to the Auth Emulator running on a different port\n  // connectAuthEmulator(auth, \"http://localhost:9099\", { disableWarnings: true });\n  // Set a test phone number and SMS code\n  auth.settings.appVerificationDisabledForTesting = true;\n}\n\n\nexport { app, auth, db, storage, functions };\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;;;;;;;;;AAC9B;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,MAAM,MAAM,IAAA,8KAAO,IAAG,MAAM,GAAG,IAAA,6KAAM,MAAK,IAAA,oLAAa,EAAC;AACxD,MAAM,OAAO,IAAA,wKAAO,EAAC;AACrB,MAAM,KAAK,IAAA,kLAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8KAAU,EAAC;AAC3B,MAAM,YAAY,IAAA,yLAAY,EAAC;AAE/B,2DAA2D;AAC3D,IAAI,+CAAkB,eAAe,OAAO,QAAQ,CAAC,QAAQ,KAAK,aAAa;IAC7E,yDAAyD;IACzD,iFAAiF;IACjF,uCAAuC;IACvC,KAAK,QAAQ,CAAC,iCAAiC,GAAG;AACpD"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/CallScreen.tsx"],"sourcesContent":["\n\"use client\";\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Mic, MicOff, Phone, Video, VideoOff } from 'lucide-react';\nimport { useAppState } from '@/utils/AppStateContext';\nimport { auth } from '@/utils/firebaseClient';\n\nexport function CallScreen({ call }: { call: any }) {\n  // All call logic and state now comes from the central AppStateContext.\n  const { pc, answerCall, handleEndCall } = useAppState();\n  \n  const [localStream, setLocalStream] = useState<MediaStream | null>(null);\n  const [remoteStream, setRemoteStream] = useState<MediaStream | null>(null);\n  const [isMuted, setIsMuted] = useState(false);\n  const [isVideoOff, setIsVideoOff] = useState(false);\n\n  const localVideoRef = useRef<HTMLVideoElement>(null);\n  const remoteVideoRef = useRef<HTMLVideoElement>(null);\n\n  const currentUser = auth.currentUser;\n  const isCallee = currentUser?.uid === call.calleeId;\n  const hasAnswered = !!call.answer;\n\n  useEffect(() => {\n    const startStreams = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });\n        setLocalStream(stream);\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = stream;\n        }\n\n        const remote = new MediaStream();\n        setRemoteStream(remote);\n        if (remoteVideoRef.current) {\n          remoteVideoRef.current.srcObject = remote;\n        }\n\n        if (pc) {\n          stream.getTracks().forEach((track) => {\n            if (!pc.getSenders().find(s => s.track === track)) {\n              pc.addTrack(track, stream);\n            }\n          });\n\n          pc.ontrack = (event) => {\n            event.streams[0].getTracks().forEach((track) => {\n              remote.addTrack(track);\n            });\n          };\n        }\n      } catch (error) {\n          console.error(\"Error accessing media devices:\", error);\n      }\n    };\n\n    startStreams();\n\n    return () => {\n      if (localStream) {\n        localStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pc]);\n\n  const toggleMute = () => {\n    if (localStream) {\n      localStream.getAudioTracks().forEach(track => track.enabled = !track.enabled);\n      setIsMuted(!isMuted);\n    }\n  }\n\n  const toggleVideo = () => {\n    if (localStream) {\n      localStream.getVideoTracks().forEach(track => track.enabled = !track.enabled);\n      setIsVideoOff(!isVideoOff);\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-[100] bg-black flex flex-col text-white\">\n      <video ref={remoteVideoRef} autoPlay playsInline className=\"w-full h-full object-cover\" />\n      \n      {/* Show a placeholder until the remote stream is available */}\n      {remoteStream?.getTracks().length === 0 && (\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-gray-900\">\n              <div className=\"w-24 h-24 rounded-full bg-gray-700 animate-pulse\"></div>\n              <p className=\"mt-4 animate-pulse\">Connecting to {call.calleeName || 'user'}...</p>\n          </div>\n      )}\n\n      <video ref={localVideoRef} autoPlay playsInline muted className=\"absolute bottom-6 right-6 w-32 h-48 object-cover rounded-lg border-2 border-accent-cyan\" />\n      \n      {isCallee && !hasAnswered && (\n        <div className=\"absolute inset-0 bg-black/70 flex flex-col items-center justify-center gap-6\">\n            <h2 className=\"text-3xl font-bold animate-pulse\">Incoming Call from {call.callerName}...</h2>\n            <div className=\"flex gap-8\">\n                <button onClick={answerCall} className=\"p-4 bg-green-500 rounded-full text-white\"><Phone size={32}/></button>\n                <button onClick={handleEndCall} className=\"p-4 bg-red-500 rounded-full text-white\"><Phone size={32}/></button>\n            </div>\n        </div>\n      )}\n\n      <div className=\"absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-6 bg-black/50 p-4 rounded-full\">\n        <button onClick={toggleMute} className={`p-3 rounded-full ${isMuted ? 'bg-red-500' : 'bg-gray-600'}`}>\n            {isMuted ? <MicOff size={24} /> : <Mic size={24} />}\n        </button>\n        <button onClick={toggleVideo} className={`p-3 rounded-full ${isVideoOff ? 'bg-red-500' : 'bg-gray-600'}`}>\n            {isVideoOff ? <VideoOff size={24} /> : <Video size={24} />}\n        </button>\n        <button onClick={handleEndCall} className=\"p-4 bg-red-500 rounded-full\">\n          <Phone size={24} />\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 364, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/utils/AppStateContext.tsx"],"sourcesContent":["\n\"use client\";\nimport React, { createContext, useState, useContext, ReactNode, useEffect, useRef } from 'react';\nimport { getFirestore, doc, onSnapshot, setDoc, serverTimestamp, Unsubscribe, updateDoc, collection, addDoc, getDoc, writeBatch, getDocs, deleteField } from 'firebase/firestore';\nimport { auth, app } from './firebaseClient';\nimport { CallScreen } from '@/components/CallScreen';\nimport { Bell, X } from 'lucide-react';\nimport { motion, AnimatePresence } from 'framer-motion';\n\nconst db = getFirestore(app);\n\n// --- Notification Prompt Component ---\ninterface NotificationPromptProps {\n  onEnable: () => void;\n  onDismiss: () => void;\n}\n\nfunction NotificationPrompt({ onEnable, onDismiss }: NotificationPromptProps) {\n    return (\n        <motion.div \n            initial={{ opacity: 0, y: 50 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 50 }}\n            className=\"fixed bottom-4 right-4 z-50 bg-gray-800 border border-gray-700 rounded-lg shadow-lg p-4 max-w-sm w-full\"\n        >\n            <div className=\"flex items-start gap-4\">\n                <div className=\"bg-accent-cyan/20 text-accent-cyan p-2 rounded-full\">\n                    <Bell size={24} />\n                </div>\n                <div className=\"flex-1\">\n                    <h4 className=\"font-bold text-white\">Enable Notifications</h4>\n                    <p className=\"text-sm text-gray-300\">Stay updated with the latest activity and never miss a call. Allow us to send you notifications.</p>\n                    <div className=\"mt-4 flex gap-2\">\n                        <button onClick={onEnable} className=\"flex-1 btn-glass bg-accent-cyan text-black text-sm\">Enable</button>\n                        <button onClick={onDismiss} className=\"flex-1 btn-glass text-sm\">Not Now</button>\n                    </div>\n                </div>\n                <button onClick={onDismiss} className=\"text-gray-400 hover:text-white\">\n                    <X size={18} />\n                </button>\n            </div>\n        </motion.div>\n    );\n}\n\n\ninterface Call {\n  id: string;\n  [key: string]: any;\n}\n\ninterface Song {\n  id: string;\n  audioUrl: string;\n  [key: string]: any;\n}\n\ninterface AppState {\n  isCalling: boolean;\n  setIsCalling: (isCalling: boolean) => void;\n  callTarget: any | null;\n  setCallTarget: (target: any | null) => void;\n  activeCall: Call | null;\n  answerCall: () => Promise<void>; \n  handleEndCall: () => Promise<void>;\n  closeCall: () => void;\n  pc: RTCPeerConnection | null;\n  activeSong: Song | null;\n  isPlaying: boolean;\n  playSong: (song: Song, queue?: Song[], index?: number) => void;\n  pauseSong: () => void;\n  toggleSong: () => void;\n  playNext: () => void;\n  playPrevious: () => void;\n  audioPlayer: HTMLAudioElement | null;\n  selectedChat: any | null;\n  setSelectedChat: React.Dispatch<React.SetStateAction<any | null>>;\n  drafts: { [chatId: string]: string };\n  setDraft: (chatId: string, text: string) => void;\n  isScopeVideoPlaying: boolean;\n  setIsScopeVideoPlaying: React.Dispatch<React.SetStateAction<boolean>>;\n}\n\nconst AppStateContext = createContext<AppState | undefined>(undefined);\n\nconst servers = {\n  iceServers: [\n    {\n      urls: ['stun:stun1.l.google.com:19302', 'stun:stun2.l.google.com:19302'],\n    },\n  ],\n  iceCandidatePoolSize: 10,\n};\n\nasync function cleanUpCall(callId: string) {\n    if (!callId) return;\n    const callDocRef = doc(db, 'calls', callId);\n    try {\n        const callDocSnap = await getDoc(callDocRef);\n        if (!callDocSnap.exists()) return;\n        const batch = writeBatch(db);\n        const offerCandidatesRef = collection(callDocRef, 'offerCandidates');\n        const answerCandidatesRef = collection(callDocRef, 'answerCandidates');\n        const offerCandidatesSnap = await getDocs(offerCandidatesRef);\n        offerCandidatesSnap.forEach(doc => batch.delete(doc.ref));\n        const answerCandidatesSnap = await getDocs(answerCandidatesRef);\n        answerCandidatesSnap.forEach(doc => batch.delete(doc.ref));\n        batch.delete(callDocRef);\n        await batch.commit();\n    } catch (error) {\n        console.error(`Error cleaning up call ${callId}:`, error);\n    }\n}\n\n\nexport function AppStateProvider({ children }: { children: ReactNode }) {\n  const [isCalling, setIsCalling] = useState(false);\n  const [callTarget, setCallTarget] = useState<any | null>(null);\n  const [activeCall, setActiveCall] = useState<Call | null>(null);\n  const [pc, setPc] = useState<RTCPeerConnection | null>(null);\n  \n  const [activeSong, setActiveSong] = useState<Song | null>(null);\n  const [songQueue, setSongQueue] = useState<Song[]>([]);\n  const [currentSongIndex, setCurrentSongIndex] = useState<number>(-1);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const [selectedChat, setSelectedChat] = useState<any | null>(null);\n  const [drafts, setDrafts] = useState<{ [chatId: string]: string }>({});\n  const [isScopeVideoPlaying, setIsScopeVideoPlaying] = useState(false);\n  const [showNotificationPrompt, setShowNotificationPrompt] = useState(false);\n\n\n  useEffect(() => {\n    let callUnsubscribe: Unsubscribe | null = null;\n    let callDocUnsubscribe: Unsubscribe | null = null;\n    let peerConnection: RTCPeerConnection | null = null;\n    let messageUnsubscribe: Unsubscribe | undefined;\n\n    const managePresence = (user: any) => {\n        if (!user) return;\n        const userDocRef = doc(db, 'users', user.uid);\n\n        const onlineData = { status: 'online', lastSeen: serverTimestamp() };\n        const offlineData = { status: 'offline', lastSeen: serverTimestamp() };\n        \n        setDoc(userDocRef, onlineData, { merge: true });\n\n        const onVisibilityChange = () => {\n             if (document.visibilityState === 'hidden') {\n                setDoc(userDocRef, offlineData, { merge: true });\n            } else {\n                setDoc(userDocRef, onlineData, { merge: true });\n            }\n        }\n        \n        window.addEventListener('visibilitychange', onVisibilityChange);\n        window.addEventListener('beforeunload', () => setDoc(userDocRef, offlineData, { merge: true }));\n\n        return () => {\n             window.removeEventListener('visibilitychange', onVisibilityChange);\n        }\n    }\n\n    const authUnsubscribe = auth.onAuthStateChanged(user => {\n      if (callUnsubscribe) callUnsubscribe();\n      if (callDocUnsubscribe) callDocUnsubscribe();\n      if (messageUnsubscribe) messageUnsubscribe();\n      \n      if (user) {\n        const userDocRef = doc(db, 'users', user.uid);\n\n        // -- NOTIFICATION LOGIC --\n        import('./firebaseMessaging').then(async (messagingModule) => {\n            const handlePermissionRequest = async () => {\n                setShowNotificationPrompt(false);\n                await messagingModule.requestNotificationPermission(user.uid);\n            };\n\n            if (typeof window !== \"undefined\" && \"Notification\" in window) {\n                const permission = Notification.permission;\n                const userDoc = await getDoc(userDocRef);\n                const fcmTokenExists = userDoc.exists() && !!userDoc.data()?.fcmToken;\n\n                if (permission === 'granted' && !fcmTokenExists) {\n                    // Permission granted but no token, silently get it.\n                    await messagingModule.requestNotificationPermission(user.uid);\n                } else if (permission === 'default') {\n                    // Not yet asked, show the custom prompt.\n                    setShowNotificationPrompt(true);\n                    // Assign handler to window to be triggered from the component.\n                    (window as any).handleNotificationPermissionRequest = handlePermissionRequest;\n                }\n            }\n            \n            messageUnsubscribe = messagingModule.onForegroundMessage(async (payload) => {\n                console.log('FCM message received in foreground:', payload);\n                const { type, callId } = payload.data || {};\n                if (type === 'incoming_call' && callId) {\n                    await updateDoc(userDocRef, { currentCallId: callId });\n                }\n            });\n        }).catch(err => console.error(\"Failed to load messaging module\", err));\n        // -- END NOTIFICATION LOGIC --\n        \n        managePresence(user);\n        \n        callUnsubscribe = onSnapshot(userDocRef, (snap) => {\n          const data = snap.data();\n          const currentCallId = data?.currentCallId;\n          \n          if (callDocUnsubscribe) callDocUnsubscribe();\n          if(peerConnection) peerConnection.close();\n\n          if (currentCallId) {\n            peerConnection = new RTCPeerConnection(servers);\n            setPc(peerConnection);\n            \n            const callDocRef = doc(db, 'calls', currentCallId);\n            callDocUnsubscribe = onSnapshot(callDocRef, (callSnap) => {\n              if (callSnap.exists()) {\n                setActiveCall({ id: callSnap.id, ...callSnap.data() });\n              } else {\n                closeCall();\n              }\n            });\n          } else {\n            closeCall();\n          }\n        });\n      } else {\n        closeCall();\n      }\n    });\n\n    return () => {\n        authUnsubscribe();\n        if (callUnsubscribe) callUnsubscribe();\n        if (callDocUnsubscribe) callDocUnsubscribe();\n        if (messageUnsubscribe) messageUnsubscribe();\n        if(pc) pc.close();\n        delete (window as any).handleNotificationPermissionRequest;\n    };\n  }, []);\n\n  const answerCall = async () => {\n    if (!pc || !activeCall) return;\n\n    const callDocRef = doc(db, 'calls', activeCall.id);\n    const answerCandidates = collection(callDocRef, 'answerCandidates');\n    const offerCandidates = collection(callDocRef, 'offerCandidates');\n\n    pc.onicecandidate = (event) => {\n      event.candidate && addDoc(answerCandidates, event.candidate.toJSON());\n    };\n\n    const callData = (await getDoc(callDocRef)).data();\n    if (callData?.offer) {\n      await pc.setRemoteDescription(new RTCSessionDescription(callData.offer));\n    }\n\n    const answerDescription = await pc.createAnswer();\n    await pc.setLocalDescription(answerDescription);\n\n    await updateDoc(callDocRef, { answer: { type: answerDescription.type, sdp: answerDescription.sdp } });\n\n    onSnapshot(offerCandidates, (snapshot) => {\n      snapshot.docChanges().forEach((change) => {\n        if (change.type === 'added') {\n          pc.addIceCandidate(new RTCIceCandidate(change.doc.data()));\n        }\n      });\n    });\n  };\n\n  const handleEndCall = async () => {\n      if (!activeCall) return;\n      const user = auth.currentUser;\n      if (!user) return;\n      \n      const callId = activeCall.id;\n      \n      closeCall(); \n\n      const userDocRef = doc(db, 'users', user.uid);\n      await updateDoc(userDocRef, { currentCallId: deleteField() });\n      \n      const otherUserId = user.uid === activeCall.callerId ? activeCall.calleeId : activeCall.callerId;\n      if(otherUserId) {\n          const otherUserDocRef = doc(db, 'users', otherUserId);\n          const otherUserDocSnap = await getDoc(otherUserDocRef);\n          if (otherUserDocSnap.exists()) {\n              await updateDoc(otherUserDocRef, { currentCallId: deleteField() });\n          }\n      }\n\n      await cleanUpCall(callId);\n  };\n  \n  useEffect(() => {\n    return () => {\n        if (audioRef.current) {\n            audioRef.current.pause();\n            audioRef.current = null;\n        }\n    }\n  }, []);\n\n  const startSong = (song: Song) => {\n    if (audioRef.current) {\n      audioRef.current.pause();\n    }\n    const audio = new Audio(song.audioUrl);\n    audioRef.current = audio;\n    audio.play();\n\n    audio.addEventListener('play', () => setIsPlaying(true));\n    audio.addEventListener('pause', () => setIsPlaying(false));\n    audio.addEventListener('ended', playNext);\n\n    setActiveSong(song);\n    setIsPlaying(true);\n  };\n  \n  const playSong = (song: Song, queue: Song[] = [], index: number = -1) => {\n    startSong(song);\n    setSongQueue(queue);\n    setCurrentSongIndex(index);\n  };\n  \n  const pauseSong = () => {\n    if(audioRef.current) {\n        audioRef.current.pause();\n    }\n  };\n  \n  const toggleSong = () => {\n      if (isPlaying) {\n          pauseSong();\n      } else if(audioRef.current) {\n          audioRef.current.play();\n      }\n  };\n\n  const playNext = () => {\n    if (songQueue.length === 0) return;\n    const nextIndex = (currentSongIndex + 1) % songQueue.length;\n    setCurrentSongIndex(nextIndex);\n    startSong(songQueue[nextIndex]);\n  };\n\n  const playPrevious = () => {\n    if (songQueue.length === 0) return;\n    const prevIndex = (currentSongIndex - 1 + songQueue.length) % songQueue.length;\n    setCurrentSongIndex(prevIndex);\n    startSong(songQueue[prevIndex]);\n  };\n\n  const closeCall = () => {\n    if(pc) {\n      pc.close();\n    }\n    setPc(null);\n    setActiveCall(null);\n  };\n\n  const setDraft = (chatId: string, text: string) => {\n    setDrafts(prev => ({...prev, [chatId]: text}));\n  }\n\n  const value = {\n    isCalling,\n    setIsCalling,\n    callTarget,\n    setCallTarget,\n    activeCall,\n    answerCall,\n    handleEndCall,\n    closeCall,\n    pc,\n    activeSong,\n    isPlaying,\n    playSong,\n    pauseSong,\n    toggleSong,\n    playNext,\n    playPrevious,\n    audioPlayer: audioRef.current,\n    selectedChat,\n    setSelectedChat,\n    drafts,\n    setDraft,\n    isScopeVideoPlaying,\n    setIsScopeVideoPlaying,\n  };\n  \n    const handleEnableClick = () => {\n        if ((window as any).handleNotificationPermissionRequest) {\n            (window as any).handleNotificationPermissionRequest();\n        }\n    };\n\n    const handleDismissClick = () => {\n        setShowNotificationPrompt(false);\n    };\n\n\n  return (\n    <AppStateContext.Provider value={value}>\n      {children}\n      {activeCall && <CallScreen call={activeCall} />}\n       <AnimatePresence>\n        {showNotificationPrompt && (\n            <NotificationPrompt \n                onEnable={handleEnableClick}\n                onDismiss={handleDismissClick}\n            />\n        )}\n      </AnimatePresence>\n    </AppStateContext.Provider>\n  );\n}\n\nexport function useAppState() {\n  const context = useContext(AppStateContext);\n  if (context === undefined) {\n    throw new Error('useAppState must be used within an AppStateProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 889, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/AppNavBar.tsx"],"sourcesContent":["\"use client\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { useAppState } from \"@/utils/AppStateContext\";\nimport { MessageSquare, ArrowLeft, Flame } from \"lucide-react\";\nimport { motion } from \"framer-motion\";\nimport { useEffect, useState } from \"react\";\nimport { getFirestore, collection, query, where, onSnapshot, getDocs } from \"firebase/firestore\";\nimport { auth, app } from \"@/utils/firebaseClient\";\nimport { getDownloadedPosts } from \"@/utils/offline-db\";\n\nconst db = getFirestore(app);\n\n// Custom SVG for VibeSpace (Home)\nconst VibeSpaceIcon = ({ className }: { className?: string }) => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className={className}>\n    <g>\n      <path d=\"M3 8L12 3L21 8V19C21 19.5523 20.5523 20 20 20H4C3.44772 20 3 19.5523 3 19V8Z\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinejoin=\"round\"/>\n      <path d=\"M8 20V14H16V20\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinejoin=\"round\"/>\n      <path d=\"M12 11L12 8\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\"/>\n    </g>\n  </svg>\n);\n\n// Custom SVG for Squad (Profile)\nconst SquadIcon = ({ className }: { className?: string }) => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className={className}>\n    <path d=\"M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n    <path d=\"M20.59 22C20.59 18.13 16.74 15 12 15C7.26 15 3.41 18.13 3.41 22\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n  </svg>\n);\n\n// Custom animated circular SVG for Flow\nconst FlowIcon = ({ className }: { className?: string }) => (\n    <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" className={className}>\n        <defs>\n            <linearGradient id=\"flowGradient\" x1=\"0\" y1=\"0\" x2=\"1\" y2=\"1\">\n                <stop offset=\"0%\" stopColor=\"var(--accent-pink)\" />\n                <stop offset=\"100%\" stopColor=\"var(--accent-cyan)\" />\n            </linearGradient>\n        </defs>\n        <circle cx=\"12\" cy=\"12\" r=\"12\" fill=\"url(#flowGradient)\" className=\"group-hover:opacity-80 transition-opacity\">\n             <animate attributeName=\"opacity\" values=\"0.7;1;0.7\" dur=\"2s\" repeatCount=\"indefinite\" />\n        </circle>\n        <path d=\"M9.5 16V8L16.5 12L9.5 16Z\" fill=\"white\"/>\n    </svg>\n);\n\n\nfunction NavButton({ href, icon: Icon, label, notificationCount }: { href: string; icon: React.ElementType; label: string; notificationCount?: number }) {\n  const pathname = usePathname();\n  const router = useRouter();\n  const isActive = pathname === href || (href === '/squad' && pathname.startsWith('/squad/'));\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    router.push(href);\n  };\n\n  return (\n    <a href={href} onClick={handleClick} className=\"relative flex flex-col items-center gap-1 px-2 py-1 text-muted-foreground hover:text-foreground transition-colors group\">\n      <Icon className={`${isActive ? 'text-brand-gold' : ''}`} />\n      <span className={`text-xs font-semibold ${isActive ? 'text-foreground' : ''}`}>{label}</span>\n      {isActive && (\n        <motion.div \n          className=\"h-[2px] w-full bg-brand-gold rounded-full mt-1\"\n          layoutId=\"nav-underline\"\n        />\n      )}\n      {notificationCount && notificationCount > 0 && (\n        <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-accent-pink rounded-full flex items-center justify-center text-white text-[10px] font-bold\">\n            {notificationCount > 9 ? '9+' : notificationCount}\n        </div>\n      )}\n    </a>\n  );\n}\n\nexport default function AppNavBar() {\n  const pathname = usePathname();\n  const { activeCall, selectedChat, setSelectedChat, isFlowVideoPlaying } = useAppState();\n  const [hasMounted, setHasMounted] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const [isOffline, setIsOffline] = useState(false);\n\n  useEffect(() => {\n    setHasMounted(true);\n\n    const checkIsMobile = () => setIsMobile(window.innerWidth < 768);\n    checkIsMobile();\n    window.addEventListener('resize', checkIsMobile);\n\n    const goOnline = () => setIsOffline(false);\n    const goOffline = () => setIsOffline(true);\n\n    window.addEventListener('online', goOnline);\n    window.addEventListener('offline', goOffline);\n\n    if (typeof navigator !== 'undefined' && !navigator.onLine) {\n        goOffline();\n    }\n\n    return () => {\n        window.removeEventListener('resize', checkIsMobile);\n        window.removeEventListener('online', goOnline);\n        window.removeEventListener('offline', goOffline);\n    };\n  }, []);\n\n  const [totalUnreadMessages, setTotalUnreadMessages] = useState(0);\n  const [hasUnreadNotifs, setHasUnreadNotifs] = useState(false);\n  const currentUser = auth.currentUser;\n  \n  useEffect(() => {\n    if (currentUser) {\n      // Dynamically import and call the function only on the client-side\n      import('@/utils/firebaseMessaging').then(messagingModule => {\n        messagingModule.requestNotificationPermission(currentUser.uid);\n      }).catch(err => {\n          console.error(\"Failed to load firebaseMessaging\", err);\n      });\n    }\n  }, [currentUser]);\n\n  // Listener for total unread messages\n  useEffect(() => {\n    if (!currentUser || isOffline) {\n        setTotalUnreadMessages(0);\n        return;\n    }\n    \n    // This listener will be complex. It needs to check multiple chat collections.\n    const fetchAllUnreadCounts = async () => {\n        let totalCount = 0;\n        const unsubs: (()=>void)[] = [];\n\n        // 1. Listen to groups\n        const groupsQuery = query(collection(db, \"groups\"), where(\"members\", \"array-contains\", currentUser.uid));\n        const unsubGroups = onSnapshot(groupsQuery, (groupsSnap) => {\n            groupsSnap.docs.forEach(groupDoc => {\n                 const q = query(\n                    collection(db, \"chats\", groupDoc.id, \"messages\"),\n                    where(\"readBy\", \"array-contains\", currentUser.uid)\n                );\n                 // This is an approximation. A more robust solution would use Cloud Functions to maintain counts.\n                 // For now, we'll just check if there are any unread messages.\n                 const unsub = onSnapshot(q, (snapshot) => {\n                     // This logic is flawed for a total count. \n                     // A better approach for this global counter might be a dedicated collection updated by cloud functions.\n                     // Let's simulate by checking for *any* unread message for now to show a badge, not a count.\n                 });\n                 unsubs.push(unsub);\n            });\n        });\n        unsubs.push(unsubGroups);\n        \n        // Let's use a simpler, less-performant but working client-side method for now.\n        // It fetches all message collections the user is a part of and counts.\n        const userChatsRef = collection(db, 'users', currentUser.uid, 'chats'); // Assuming such a collection exists for simplicity\n        \n        // This is a placeholder for a more complex aggregation logic that would be needed for a precise count.\n        // A true implementation often requires cloud functions.\n        // For the purpose of this demo, we'll leave the total count as a placeholder.\n        // The logic on the `signal` page will show the per-chat count correctly.\n\n    };\n    \n    // The total unread count logic is complex and better handled by cloud functions for performance.\n    // For this UI change, we'll focus on the per-chat display on the signal page and a simple notification indicator here.\n\n  }, [currentUser, isOffline]);\n\n  // Listener for general notifications\n  useEffect(() => {\n    if (!currentUser || isOffline) {\n        setHasUnreadNotifs(false);\n        return;\n    }\n    const q = query(collection(db, \"users\", currentUser.uid, \"notifications\"), where(\"read\", \"==\", false));\n    const unsub = onSnapshot(q, (snapshot) => {\n        setHasUnreadNotifs(!snapshot.empty);\n    });\n    return () => unsub();\n  }, [currentUser, isOffline]);\n\n\n  const isAuthPage = pathname === \"/login\" || pathname === \"/signup\" || pathname === \"/\";\n  const isSpecialPage = [\"/guest\", \"/about\", \"/privacy\", \"/terms\", \"/contact\"].includes(pathname);\n  const hideNav = isAuthPage || isSpecialPage || !!activeCall;\n  const hideForFlowVideo = pathname.startsWith('/flow') && isFlowVideoPlaying;\n\n\n  if (!hasMounted || hideNav || hideForFlowVideo) return null;\n\n  const isSignalChatView = isMobile && pathname.startsWith('/signal/') && selectedChat;\n\n  return (\n    <>\n      {isOffline && (\n        <div className=\"fixed bottom-0 left-0 w-full z-50 bg-yellow-500/90 backdrop-blur-md text-black font-bold p-2 text-center text-sm\">\n            You are offline. Some features may be limited.\n        </div>\n      )}\n      <nav className={`fixed left-0 w-full z-40 bg-background/50 backdrop-blur-lg border-t border-glass-border flex justify-around items-center py-2 transition-all ${isOffline ? 'bottom-8' : 'bottom-0'}`}>\n        {isSignalChatView ? (\n          <button onClick={() => { setSelectedChat(null); router.back(); }} className=\"flex flex-col items-center gap-1 px-2 py-1 text-foreground\">\n            <ArrowLeft />\n            <span className=\"text-xs font-semibold\">Back</span>\n          </button>\n        ) : (\n          <>\n            <NavButton href=\"/home\" icon={VibeSpaceIcon} label=\"VibeSpace\" />\n            <NavButton href=\"/flow\" icon={FlowIcon} label=\"Flow\" />\n            <NavButton href=\"/squad\" icon={SquadIcon} label=\"Squad\" />\n            <NavButton href=\"/signal\" icon={MessageSquare} label=\"Signal\" notificationCount={totalUnreadMessages > 0 ? totalUnreadMessages : undefined} />\n          </>\n        )}\n      </nav>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;;;AAPA;;;;;;;;AAUA,MAAM,KAAK,IAAA,kLAAY,EAAC,wIAAG;AAE3B,kCAAkC;AAClC,MAAM,gBAAgB,CAAC,EAAE,SAAS,EAA0B,iBAC1D,6LAAC;QAAI,OAAM;QAAK,QAAO;QAAK,SAAQ;QAAY,MAAK;QAAO,OAAM;QAA6B,WAAW;kBACxG,cAAA,6LAAC;;8BACC,6LAAC;oBAAK,GAAE;oBAA+E,QAAO;oBAAe,aAAY;oBAAM,gBAAe;;;;;;8BAC9I,6LAAC;oBAAK,GAAE;oBAAiB,QAAO;oBAAe,aAAY;oBAAM,gBAAe;;;;;;8BAChF,6LAAC;oBAAK,GAAE;oBAAc,QAAO;oBAAe,aAAY;oBAAM,eAAc;;;;;;;;;;;;;;;;;KAL5E;AAUN,iCAAiC;AACjC,MAAM,YAAY,CAAC,EAAE,SAAS,EAA0B,iBACtD,6LAAC;QAAI,OAAM;QAAK,QAAO;QAAK,SAAQ;QAAY,MAAK;QAAO,OAAM;QAA6B,WAAW;;0BACxG,6LAAC;gBAAK,GAAE;gBAAkH,QAAO;gBAAe,aAAY;gBAAM,eAAc;gBAAQ,gBAAe;;;;;;0BACvM,6LAAC;gBAAK,GAAE;gBAAkE,QAAO;gBAAe,aAAY;gBAAM,eAAc;gBAAQ,gBAAe;;;;;;;;;;;;MAHrJ;AAON,wCAAwC;AACxC,MAAM,WAAW,CAAC,EAAE,SAAS,EAA0B,iBACnD,6LAAC;QAAI,OAAM;QAAK,QAAO;QAAK,SAAQ;QAAY,MAAK;QAAO,OAAM;QAA6B,WAAW;;0BACtG,6LAAC;0BACG,cAAA,6LAAC;oBAAe,IAAG;oBAAe,IAAG;oBAAI,IAAG;oBAAI,IAAG;oBAAI,IAAG;;sCACtD,6LAAC;4BAAK,QAAO;4BAAK,WAAU;;;;;;sCAC5B,6LAAC;4BAAK,QAAO;4BAAO,WAAU;;;;;;;;;;;;;;;;;0BAGtC,6LAAC;gBAAO,IAAG;gBAAK,IAAG;gBAAK,GAAE;gBAAK,MAAK;gBAAqB,WAAU;0BAC9D,cAAA,6LAAC;oBAAQ,eAAc;oBAAU,QAAO;oBAAY,KAAI;oBAAK,aAAY;;;;;;;;;;;0BAE9E,6LAAC;gBAAK,GAAE;gBAA4B,MAAK;;;;;;;;;;;;MAX3C;AAgBN,SAAS,UAAU,EAAE,IAAI,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,iBAAiB,EAAwF;;IACrJ,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,UAAS,IAAA,kJAAS;IACxB,MAAM,WAAW,aAAa,QAAS,SAAS,YAAY,SAAS,UAAU,CAAC;IAEhF,MAAM,cAAc,CAAC;QACnB,EAAE,cAAc;QAChB,QAAO,IAAI,CAAC;IACd;IAEA,qBACE,6LAAC;QAAE,MAAM;QAAM,SAAS;QAAa,WAAU;;0BAC7C,6LAAC;gBAAK,WAAW,GAAG,WAAW,oBAAoB,IAAI;;;;;;0BACvD,6LAAC;gBAAK,WAAW,CAAC,sBAAsB,EAAE,WAAW,oBAAoB,IAAI;0BAAG;;;;;;YAC/E,0BACC,6LAAC,uMAAM,CAAC,GAAG;gBACT,WAAU;gBACV,UAAS;;;;;;YAGZ,qBAAqB,oBAAoB,mBACxC,6LAAC;gBAAI,WAAU;0BACV,oBAAoB,IAAI,OAAO;;;;;;;;;;;;AAK5C;GA3BS;;QACU,oJAAW;QACb,kJAAS;;;MAFjB;AA6BM,SAAS;;IACtB,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE,eAAe,EAAE,kBAAkB,EAAE,GAAG,IAAA,kJAAW;IACrF,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;+BAAC;YACR,cAAc;YAEd,MAAM;qDAAgB,IAAM,YAAY,OAAO,UAAU,GAAG;;YAC5D;YACA,OAAO,gBAAgB,CAAC,UAAU;YAElC,MAAM;gDAAW,IAAM,aAAa;;YACpC,MAAM;iDAAY,IAAM,aAAa;;YAErC,OAAO,gBAAgB,CAAC,UAAU;YAClC,OAAO,gBAAgB,CAAC,WAAW;YAEnC,IAAI,OAAO,cAAc,eAAe,CAAC,UAAU,MAAM,EAAE;gBACvD;YACJ;YAEA;uCAAO;oBACH,OAAO,mBAAmB,CAAC,UAAU;oBACrC,OAAO,mBAAmB,CAAC,UAAU;oBACrC,OAAO,mBAAmB,CAAC,WAAW;gBAC1C;;QACF;8BAAG,EAAE;IAEL,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,cAAc,yIAAI,CAAC,WAAW;IAEpC,IAAA,0KAAS;+BAAC;YACR,IAAI,aAAa;gBACf,mEAAmE;gBACnE,4GAAoC,IAAI;2CAAC,CAAA;wBACvC,gBAAgB,6BAA6B,CAAC,YAAY,GAAG;oBAC/D;0CAAG,KAAK;2CAAC,CAAA;wBACL,QAAQ,KAAK,CAAC,oCAAoC;oBACtD;;YACF;QACF;8BAAG;QAAC;KAAY;IAEhB,qCAAqC;IACrC,IAAA,0KAAS;+BAAC;YACR,IAAI,CAAC,eAAe,WAAW;gBAC3B,uBAAuB;gBACvB;YACJ;YAEA,8EAA8E;YAC9E,MAAM;4DAAuB;oBACzB,IAAI,aAAa;oBACjB,MAAM,SAAuB,EAAE;oBAE/B,sBAAsB;oBACtB,MAAM,cAAc,IAAA,2KAAK,EAAC,IAAA,gLAAU,EAAC,IAAI,WAAW,IAAA,2KAAK,EAAC,WAAW,kBAAkB,YAAY,GAAG;oBACtG,MAAM,cAAc,IAAA,gLAAU,EAAC;gFAAa,CAAC;4BACzC,WAAW,IAAI,CAAC,OAAO;wFAAC,CAAA;oCACnB,MAAM,IAAI,IAAA,2KAAK,EACZ,IAAA,gLAAU,EAAC,IAAI,SAAS,SAAS,EAAE,EAAE,aACrC,IAAA,2KAAK,EAAC,UAAU,kBAAkB,YAAY,GAAG;oCAEpD,iGAAiG;oCACjG,8DAA8D;oCAC9D,MAAM,QAAQ,IAAA,gLAAU,EAAC;sGAAG,CAAC;wCACzB,2CAA2C;wCAC3C,wGAAwG;wCACxG,4FAA4F;wCAChG;;oCACA,OAAO,IAAI,CAAC;gCACjB;;wBACJ;;oBACA,OAAO,IAAI,CAAC;oBAEZ,+EAA+E;oBAC/E,uEAAuE;oBACvE,MAAM,eAAe,IAAA,gLAAU,EAAC,IAAI,SAAS,YAAY,GAAG,EAAE,UAAU,mDAAmD;gBAE3H,uGAAuG;gBACvG,wDAAwD;gBACxD,8EAA8E;gBAC9E,yEAAyE;gBAE7E;;QAEA,iGAAiG;QACjG,uHAAuH;QAEzH;8BAAG;QAAC;QAAa;KAAU;IAE3B,qCAAqC;IACrC,IAAA,0KAAS;+BAAC;YACR,IAAI,CAAC,eAAe,WAAW;gBAC3B,mBAAmB;gBACnB;YACJ;YACA,MAAM,IAAI,IAAA,2KAAK,EAAC,IAAA,gLAAU,EAAC,IAAI,SAAS,YAAY,GAAG,EAAE,kBAAkB,IAAA,2KAAK,EAAC,QAAQ,MAAM;YAC/F,MAAM,QAAQ,IAAA,gLAAU,EAAC;6CAAG,CAAC;oBACzB,mBAAmB,CAAC,SAAS,KAAK;gBACtC;;YACA;uCAAO,IAAM;;QACf;8BAAG;QAAC;QAAa;KAAU;IAG3B,MAAM,aAAa,aAAa,YAAY,aAAa,aAAa,aAAa;IACnF,MAAM,gBAAgB;QAAC;QAAU;QAAU;QAAY;QAAU;KAAW,CAAC,QAAQ,CAAC;IACtF,MAAM,UAAU,cAAc,iBAAiB,CAAC,CAAC;IACjD,MAAM,mBAAmB,SAAS,UAAU,CAAC,YAAY;IAGzD,IAAI,CAAC,cAAc,WAAW,kBAAkB,OAAO;IAEvD,MAAM,mBAAmB,YAAY,SAAS,UAAU,CAAC,eAAe;IAExE,qBACE;;YACG,2BACC,6LAAC;gBAAI,WAAU;0BAAmH;;;;;;0BAIpI,6LAAC;gBAAI,WAAW,CAAC,6IAA6I,EAAE,YAAY,aAAa,YAAY;0BAClM,iCACC,6LAAC;oBAAO,SAAS;wBAAQ,gBAAgB;wBAAO,OAAO,IAAI;oBAAI;oBAAG,WAAU;;sCAC1E,6LAAC,gOAAS;;;;;sCACV,6LAAC;4BAAK,WAAU;sCAAwB;;;;;;;;;;;yCAG1C;;sCACE,6LAAC;4BAAU,MAAK;4BAAQ,MAAM;4BAAe,OAAM;;;;;;sCACnD,6LAAC;4BAAU,MAAK;4BAAQ,MAAM;4BAAU,OAAM;;;;;;sCAC9C,6LAAC;4BAAU,MAAK;4BAAS,MAAM;4BAAW,OAAM;;;;;;sCAChD,6LAAC;4BAAU,MAAK;4BAAU,MAAM,4OAAa;4BAAE,OAAM;4BAAS,mBAAmB,sBAAsB,IAAI,sBAAsB;;;;;;;;;;;;;;;AAM7I;IA9IwB;;QACL,oJAAW;QAC8C,kJAAW;;;MAF/D"}},
    {"offset": {"line": 1388, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/GlobalMusicPlayer.tsx"],"sourcesContent":["\n\"use client\";\nimport React from 'react';\nimport { useAppState } from '@/utils/AppStateContext';\nimport { Play, Pause, X, SkipBack, SkipForward } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport function GlobalMusicPlayer() {\n  const { activeSong, isPlaying, toggleSong, playNext, playPrevious } = useAppState();\n\n  if (!activeSong) {\n    return null;\n  }\n\n  return (\n    <motion.div\n      initial={{ y: 100 }}\n      animate={{ y: 0 }}\n      exit={{ y: 100 }}\n      transition={{ type: 'spring', stiffness: 300, damping: 30 }}\n      className=\"fixed bottom-20 md:bottom-4 left-4 right-4 md:left-auto md:max-w-md z-50\"\n    >\n      <div className=\"glass-card p-3 flex items-center gap-4\">\n        <img\n          src={activeSong.albumArtUrl}\n          alt={activeSong.title}\n          className=\"w-14 h-14 rounded-lg object-cover\"\n        />\n        <div className=\"flex-1 overflow-hidden\">\n          <p className=\"font-bold text-accent-cyan truncate\">{activeSong.title}</p>\n          <p className=\"text-sm text-gray-400 truncate\">{activeSong.artist}</p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <button onClick={playPrevious} className=\"p-2 text-gray-300 hover:text-white transition-colors\">\n            <SkipBack size={20} />\n          </button>\n          <button\n            onClick={toggleSong}\n            className=\"p-3 rounded-full bg-accent-cyan text-black shadow-lg hover:scale-110 transition-transform\"\n          >\n            {isPlaying ? <Pause size={20} /> : <Play size={20} />}\n          </button>\n          <button onClick={playNext} className=\"p-2 text-gray-300 hover:text-white transition-colors\">\n            <SkipForward size={20} />\n          </button>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAAA;AAAA;AACA;;;AAJA;;;;AAMO,SAAS;;IACd,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,QAAQ,EAAE,YAAY,EAAE,GAAG,IAAA,kJAAW;IAEjF,IAAI,CAAC,YAAY;QACf,OAAO;IACT;IAEA,qBACE,6LAAC,uMAAM,CAAC,GAAG;QACT,SAAS;YAAE,GAAG;QAAI;QAClB,SAAS;YAAE,GAAG;QAAE;QAChB,MAAM;YAAE,GAAG;QAAI;QACf,YAAY;YAAE,MAAM;YAAU,WAAW;YAAK,SAAS;QAAG;QAC1D,WAAU;kBAEV,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBACC,KAAK,WAAW,WAAW;oBAC3B,KAAK,WAAW,KAAK;oBACrB,WAAU;;;;;;8BAEZ,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAE,WAAU;sCAAuC,WAAW,KAAK;;;;;;sCACpE,6LAAC;4BAAE,WAAU;sCAAkC,WAAW,MAAM;;;;;;;;;;;;8BAElE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAO,SAAS;4BAAc,WAAU;sCACvC,cAAA,6LAAC,6NAAQ;gCAAC,MAAM;;;;;;;;;;;sCAElB,6LAAC;4BACC,SAAS;4BACT,WAAU;sCAET,0BAAY,6LAAC,gNAAK;gCAAC,MAAM;;;;;qDAAS,6LAAC,6MAAI;gCAAC,MAAM;;;;;;;;;;;sCAEjD,6LAAC;4BAAO,SAAS;4BAAU,WAAU;sCACnC,cAAA,6LAAC,sOAAW;gCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM/B;GA1CgB;;QACwD,kJAAW;;;KADnE"}},
    {"offset": {"line": 1551, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/firebase/error-emitter.ts"],"sourcesContent":["import { EventEmitter } from 'events';\n\n// A simple, global event emitter to decouple error reporting from error handling.\n// Components can emit 'permission-error' and a central listener can handle it.\nexport const errorEmitter = new EventEmitter();\n"],"names":[],"mappings":";;;;AAAA;;AAIO,MAAM,eAAe,IAAI,mJAAY"}},
    {"offset": {"line": 1565, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/use-toast.ts"],"sourcesContent":["\"use client\"\n\n// Inspired by react-hot-toast library\nimport * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1732, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/FirebaseErrorListener.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect } from 'react';\nimport { errorEmitter } from '@/firebase/error-emitter';\nimport { FirestorePermissionError } from '@/firebase/errors';\nimport { useToast } from \"@/hooks/use-toast\";\n\n/**\n * A client-side component that listens for Firestore permission errors\n * and displays them using a toast notification. This is crucial for\n * debugging security rules during development.\n */\nexport function FirebaseErrorListener() {\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const handleError = (error: FirestorePermissionError) => {\n      console.error(\"Caught Firestore Permission Error:\", error);\n\n      // Display a detailed toast notification for developers.\n      // This provides immediate feedback on why a request was denied.\n      toast({\n        variant: \"destructive\",\n        title: \"Firestore Security Rule Denied\",\n        description: (\n          <pre className=\"mt-2 w-full rounded-md bg-slate-950 p-4\">\n            <code className=\"text-white whitespace-pre-wrap\">{error.message}</code>\n          </pre>\n        ),\n        duration: 20000, // Give developers ample time to read it\n      });\n    };\n\n    errorEmitter.on('permission-error', handleError);\n\n    return () => {\n      errorEmitter.off('permission-error', handleError);\n    };\n  }, [toast]);\n\n  return null; // This component does not render anything itself.\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;;;AALA;;;;AAYO,SAAS;;IACd,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,2IAAQ;IAE1B,IAAA,0KAAS;2CAAC;YACR,MAAM;+DAAc,CAAC;oBACnB,QAAQ,KAAK,CAAC,sCAAsC;oBAEpD,wDAAwD;oBACxD,gEAAgE;oBAChE,MAAM;wBACJ,SAAS;wBACT,OAAO;wBACP,2BACE,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAK,WAAU;0CAAkC,MAAM,OAAO;;;;;;;;;;;wBAGnE,UAAU;oBACZ;gBACF;;YAEA,sJAAY,CAAC,EAAE,CAAC,oBAAoB;YAEpC;mDAAO;oBACL,sJAAY,CAAC,GAAG,CAAC,oBAAoB;gBACvC;;QACF;0CAAG;QAAC;KAAM;IAEV,OAAO,MAAM,kDAAkD;AACjE;GA7BgB;;QACI,2IAAQ;;;KADZ"}},
    {"offset": {"line": 1805, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n \nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 1823, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/toast.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,gBAAgB,gLAAwB;AAE9C,MAAM,8BAAgB,2KAAgB,MAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,gLAAwB;QACvB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,qIACA;QAED,GAAG,KAAK;;;;;;;AAGb,cAAc,WAAW,GAAG,gLAAwB,CAAC,WAAW;AAEhE,MAAM,gBAAgB,IAAA,0KAAG,EACvB,6lBACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,2KAAgB,OAI5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE;IACnC,qBACE,6LAAC,4KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;;AACA,MAAM,WAAW,GAAG,4KAAoB,CAAC,WAAW;AAEpD,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,sgBACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAsB,CAAC,WAAW;AAE5D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,yVACA;QAEF,eAAY;QACX,GAAG,KAAK;kBAET,cAAA,6LAAC,oMAAC;YAAC,WAAU;;;;;;;;;;;;AAGjB,WAAW,WAAW,GAAG,6KAAqB,CAAC,WAAW;AAE1D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,6KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG,6KAAqB,CAAC,WAAW;AAE1D,MAAM,iCAAmB,2KAAgB,QAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,mLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,sBAAsB;QACnC,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,mLAA2B,CAAC,WAAW"}},
    {"offset": {"line": 1963, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/toaster.tsx"],"sourcesContent":["\n\"use client\"\n\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\nimport { useToast } from \"@/hooks/use-toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;AAGA;AAQA;;;AAVA;;;AAYO,SAAS;;IACd,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,2IAAQ;IAE3B,qBACE,6LAAC,qJAAa;;YACX,OAAO,GAAG,CAAC,SAAU,EAAE,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE,MAAM,EAAE,GAAG,OAAO;gBAChE,qBACE,6LAAC,6IAAK;oBAAW,GAAG,KAAK;;sCACvB,6LAAC;4BAAI,WAAU;;gCACZ,uBAAS,6LAAC,kJAAU;8CAAE;;;;;;gCACtB,6BACC,6LAAC,wJAAgB;8CAAE;;;;;;;;;;;;wBAGtB;sCACD,6LAAC,kJAAU;;;;;;mBARD;;;;;YAWhB;0BACA,6LAAC,qJAAa;;;;;;;;;;;AAGpB;GAtBgB;;QACK,2IAAQ;;;KADb"}},
    {"offset": {"line": 2047, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/providers.tsx"],"sourcesContent":["\"use client\";\n\nimport AppNavBar from \"./AppNavBar\";\nimport { GlobalMusicPlayer } from \"@/components/GlobalMusicPlayer\";\nimport { FirebaseErrorListener } from \"@/components/FirebaseErrorListener\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport dynamic from 'next/dynamic';\n\n// Dynamically import AppStateProvider with SSR disabled\nconst AppStateProvider = dynamic(\n  () => import('@/utils/AppStateContext').then((mod) => mod.AppStateProvider),\n  { ssr: false }\n);\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n    return (\n        <AppStateProvider>\n          <FirebaseErrorListener />\n          <Toaster />\n          <main className=\"pb-20 pt-6 px-4\">{children}</main>\n          <GlobalMusicPlayer />\n          <AppNavBar />\n        </AppStateProvider>\n    )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;;AANA;;;;;;;AAQA,wDAAwD;AACxD,MAAM,mBAAmB,IAAA,6KAAO,EAC9B,IAAM,+HAAkC,IAAI,CAAC,CAAC,MAAQ,IAAI,gBAAgB;;;;;;IACxE,KAAK;;KAFH;AAKC,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACjE,qBACI,6LAAC;;0BACC,6LAAC,uKAAqB;;;;;0BACtB,6LAAC,iJAAO;;;;;0BACR,6LAAC;gBAAK,WAAU;0BAAmB;;;;;;0BACnC,6LAAC,+JAAiB;;;;;0BAClB,6LAAC,sIAAS;;;;;;;;;;;AAGpB;MAVgB"}},
    {"offset": {"line": 2124, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/BodyStyling.tsx"],"sourcesContent":["\"use client\";\n\nimport { usePathname } from 'next/navigation';\nimport { useEffect, useState } from 'react';\nimport { auth } from '@/utils/firebaseClient';\n\nexport default function BodyStyling() {\n  const pathname = usePathname();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setIsAuthenticated(!!user);\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  useEffect(() => {\n    // Define logged-out pages\n    const loggedOutPages = [\n        '/',\n        '/login',\n        '/signup',\n        '/about',\n        '/privacy',\n        '/terms',\n        '/contact'\n    ];\n    \n    // Default to logged-out style while loading auth state\n    if (loading) {\n        document.body.classList.add('logged-out-background');\n        document.body.classList.remove('logged-in-background');\n        return;\n    }\n\n    // Check if the current path is one of the logged-out pages\n    const isLoggedOutPage = loggedOutPages.includes(pathname);\n\n    if (isAuthenticated && !isLoggedOutPage) {\n      document.body.classList.add('logged-in-background');\n      document.body.classList.remove('logged-out-background');\n    } else {\n      document.body.classList.add('logged-out-background');\n      document.body.classList.remove('logged-in-background');\n    }\n\n    // Cleanup function to remove classes when the component unmounts\n    return () => {\n      document.body.classList.remove('logged-in-background', 'logged-out-background');\n    };\n  }, [pathname, isAuthenticated, loading]);\n\n  return null; // This component does not render anything\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAMe,SAAS;;IACtB,MAAM,WAAW,IAAA,oJAAW;IAC5B,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;iCAAC;YACR,MAAM,cAAc,yIAAI,CAAC,kBAAkB;qDAAC,CAAA;oBAC1C,mBAAmB,CAAC,CAAC;oBACrB,WAAW;gBACb;;YACA;yCAAO,IAAM;;QACf;gCAAG,EAAE;IAEL,IAAA,0KAAS;iCAAC;YACR,0BAA0B;YAC1B,MAAM,iBAAiB;gBACnB;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;aACH;YAED,uDAAuD;YACvD,IAAI,SAAS;gBACT,SAAS,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;gBAC5B,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC/B;YACJ;YAEA,2DAA2D;YAC3D,MAAM,kBAAkB,eAAe,QAAQ,CAAC;YAEhD,IAAI,mBAAmB,CAAC,iBAAiB;gBACvC,SAAS,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;gBAC5B,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACjC,OAAO;gBACL,SAAS,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;gBAC5B,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;YACjC;YAEA,iEAAiE;YACjE;yCAAO;oBACL,SAAS,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,wBAAwB;gBACzD;;QACF;gCAAG;QAAC;QAAU;QAAiB;KAAQ;IAEvC,OAAO,MAAM,0CAA0C;AACzD;GAlDwB;;QACL,oJAAW;;;KADN"}}]
}