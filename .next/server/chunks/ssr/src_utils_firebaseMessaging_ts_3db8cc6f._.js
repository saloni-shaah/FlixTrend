module.exports=[37093,a=>{"use strict";var b,c,d,e,f=a.i(88156),g=a.i(57179),h=a.i(69304),i=a.i(77058);let j="@firebase/installations",k="0.6.19",l=`w:${k}`,m="FIS_v2",n=new h.ErrorFactory("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function o(a){return a instanceof h.FirebaseError&&a.code.includes("request-failed")}function p({projectId:a}){return`https://firebaseinstallations.googleapis.com/v1/projects/${a}/installations`}function q(a){return{token:a.token,requestStatus:2,expiresIn:Number(a.expiresIn.replace("s","000")),creationTime:Date.now()}}async function r(a,b){let c=(await b.json()).error;return n.create("request-failed",{requestName:a,serverCode:c.code,serverMessage:c.message,serverStatus:c.status})}function s({apiKey:a}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":a})}async function t(a){let b=await a();return b.status>=500&&b.status<600?a():b}async function u({appConfig:a,heartbeatServiceProvider:b},{fid:c}){let d=p(a),e=s(a),f=b.getImmediate({optional:!0});if(f){let a=await f.getHeartbeatsHeader();a&&e.append("x-firebase-client",a)}let g={method:"POST",headers:e,body:JSON.stringify({fid:c,authVersion:m,appId:a.appId,sdkVersion:l})},h=await t(()=>fetch(d,g));if(h.ok){let a=await h.json();return{fid:a.fid||c,registrationStatus:2,refreshToken:a.refreshToken,authToken:q(a.authToken)}}throw await r("Create Installation",h)}function v(a){return new Promise(b=>{setTimeout(b,a)})}let w=/^[cdef][\w-]{21}$/;function x(a){return`${a.appName}!${a.appId}`}let y=new Map;function z(a,b){var c,d;let e,f=x(a);A(f,b),c=f,d=b,(e=(!B&&"BroadcastChannel"in self&&((B=new BroadcastChannel("[Firebase] FID Change")).onmessage=a=>{A(a.data.key,a.data.fid)}),B))&&e.postMessage({key:c,fid:d}),0===y.size&&B&&(B.close(),B=null)}function A(a,b){let c=y.get(a);if(c)for(let a of c)a(b)}let B=null,C="firebase-installations-store",D=null;function E(){return D||(D=(0,i.openDB)("firebase-installations-database",1,{upgrade:(a,b)=>{0===b&&a.createObjectStore(C)}})),D}async function F(a,b){let c=x(a),d=(await E()).transaction(C,"readwrite"),e=d.objectStore(C),f=await e.get(c);return await e.put(b,c),await d.done,f&&f.fid===b.fid||z(a,b.fid),b}async function G(a){let b=x(a),c=(await E()).transaction(C,"readwrite");await c.objectStore(C).delete(b),await c.done}async function H(a,b){let c=x(a),d=(await E()).transaction(C,"readwrite"),e=d.objectStore(C),f=await e.get(c),g=b(f);return void 0===g?await e.delete(c):await e.put(g,c),await d.done,g&&(!f||f.fid!==g.fid)&&z(a,g.fid),g}async function I(a){let b,c=await H(a.appConfig,c=>{let d=function(a,b){if(0===b.registrationStatus){if(!navigator.onLine)return{installationEntry:b,registrationPromise:Promise.reject(n.create("app-offline"))};let c={fid:b.fid,registrationStatus:1,registrationTime:Date.now()},d=J(a,c);return{installationEntry:c,registrationPromise:d}}return 1===b.registrationStatus?{installationEntry:b,registrationPromise:K(a)}:{installationEntry:b}}(a,M(c||{fid:function(){try{var a;let b=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(b),b[0]=112+b[0]%16;let c=(a=b,btoa(String.fromCharCode(...a)).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22));return w.test(c)?c:""}catch{return""}}(),registrationStatus:0}));return b=d.registrationPromise,d.installationEntry});return""===c.fid?{installationEntry:await b}:{installationEntry:c,registrationPromise:b}}async function J(a,b){try{let c=await u(a,b);return F(a.appConfig,c)}catch(c){throw o(c)&&409===c.customData.serverCode?await G(a.appConfig):await F(a.appConfig,{fid:b.fid,registrationStatus:0}),c}}async function K(a){let b=await L(a.appConfig);for(;1===b.registrationStatus;)await v(100),b=await L(a.appConfig);if(0===b.registrationStatus){let{installationEntry:b,registrationPromise:c}=await I(a);return c||b}return b}function L(a){return H(a,a=>{if(!a)throw n.create("installation-not-found");return M(a)})}function M(a){var b;return 1===(b=a).registrationStatus&&b.registrationTime+1e4<Date.now()?{fid:a.fid,registrationStatus:0}:a}async function N({appConfig:a,heartbeatServiceProvider:b},c){let d=function(a,{fid:b}){return`${p(a)}/${b}/authTokens:generate`}(a,c),e=function(a,{refreshToken:b}){var c;let d=s(a);return d.append("Authorization",(c=b,`${m} ${c}`)),d}(a,c),f=b.getImmediate({optional:!0});if(f){let a=await f.getHeartbeatsHeader();a&&e.append("x-firebase-client",a)}let g={method:"POST",headers:e,body:JSON.stringify({installation:{sdkVersion:l,appId:a.appId}})},h=await t(()=>fetch(d,g));if(h.ok)return q(await h.json());throw await r("Generate Auth Token",h)}async function O(a,b=!1){let c,d=await H(a.appConfig,d=>{var e,f,g;let h;if(!S(d))throw n.create("not-registered");let i=d.authToken;if(!b&&2===(e=i).requestStatus&&(f=e,!((h=Date.now())<f.creationTime)&&!(f.creationTime+f.expiresIn<h+36e5)))return d;if(1===i.requestStatus)return c=P(a,b),d;{let b;if(!navigator.onLine)throw n.create("app-offline");let e=(g=d,b={requestStatus:1,requestTime:Date.now()},{...g,authToken:b});return c=R(a,e),e}});return c?await c:d.authToken}async function P(a,b){let c=await Q(a.appConfig);for(;1===c.authToken.requestStatus;)await v(100),c=await Q(a.appConfig);let d=c.authToken;return 0===d.requestStatus?O(a,b):d}function Q(a){return H(a,a=>{var b;if(!S(a))throw n.create("not-registered");return 1===(b=a.authToken).requestStatus&&b.requestTime+1e4<Date.now()?{...a,authToken:{requestStatus:0}}:a})}async function R(a,b){try{let c=await N(a,b),d={...b,authToken:c};return await F(a.appConfig,d),c}catch(c){if(o(c)&&(401===c.customData.serverCode||404===c.customData.serverCode))await G(a.appConfig);else{let c={...b,authToken:{requestStatus:0}};await F(a.appConfig,c)}throw c}}function S(a){return void 0!==a&&2===a.registrationStatus}async function T(a){let{installationEntry:b,registrationPromise:c}=await I(a);return c?c.catch(console.error):O(a).catch(console.error),b.fid}async function U(a,b=!1){return await V(a),(await O(a,b)).token}async function V(a){let{registrationPromise:b}=await I(a);b&&await b}function W(a){return n.create("missing-app-config-values",{valueName:a})}let X="installations";(0,f._registerComponent)(new g.Component(X,a=>{let b=a.getProvider("app").getImmediate(),c=function(a){if(!a||!a.options)throw W("App Configuration");if(!a.name)throw W("App Name");for(let b of["projectId","apiKey","appId"])if(!a.options[b])throw W(b);return{appName:a.name,projectId:a.options.projectId,apiKey:a.options.apiKey,appId:a.options.appId}}(b),d=(0,f._getProvider)(b,"heartbeat");return{app:b,appConfig:c,heartbeatServiceProvider:d,_delete:()=>Promise.resolve()}},"PUBLIC")),(0,f._registerComponent)(new g.Component("installations-internal",a=>{let b=a.getProvider("app").getImmediate(),c=(0,f._getProvider)(b,X).getImmediate();return{getId:()=>T(c),getToken:a=>U(c,a)}},"PRIVATE")),(0,f.registerVersion)(j,k),(0,f.registerVersion)(j,k,"esm2020");let Y="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Z="google.c.a.c_id";function $(a){return btoa(String.fromCharCode(...new Uint8Array(a))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(b=d||(d={}))[b.DATA_MESSAGE=1]="DATA_MESSAGE",b[b.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION",(c=e||(e={})).PUSH_RECEIVED="push-received",c.NOTIFICATION_CLICKED="notification-clicked";let _="fcm_token_details_db",aa="fcm_token_object_Store";async function ab(a){if("databases"in indexedDB&&!(await indexedDB.databases()).map(a=>a.name).includes(_))return null;let b=null;return(await (0,i.openDB)(_,5,{upgrade:async(c,d,e,f)=>{if(d<2||!c.objectStoreNames.contains(aa))return;let g=f.objectStore(aa),h=await g.index("fcmSenderId").get(a);if(await g.clear(),h)if(2===d){if(!h.auth||!h.p256dh||!h.endpoint)return;b={token:h.fcmToken,createTime:h.createTime??Date.now(),subscriptionOptions:{auth:h.auth,p256dh:h.p256dh,endpoint:h.endpoint,swScope:h.swScope,vapidKey:"string"==typeof h.vapidKey?h.vapidKey:$(h.vapidKey)}}}else 3===d?b={token:h.fcmToken,createTime:h.createTime,subscriptionOptions:{auth:$(h.auth),p256dh:$(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:$(h.vapidKey)}}:4===d&&(b={token:h.fcmToken,createTime:h.createTime,subscriptionOptions:{auth:$(h.auth),p256dh:$(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:$(h.vapidKey)}})}})).close(),await (0,i.deleteDB)(_),await (0,i.deleteDB)("fcm_vapid_details_db"),await (0,i.deleteDB)("undefined"),!function(a){if(!a||!a.subscriptionOptions)return!1;let{subscriptionOptions:b}=a;return"number"==typeof a.createTime&&a.createTime>0&&"string"==typeof a.token&&a.token.length>0&&"string"==typeof b.auth&&b.auth.length>0&&"string"==typeof b.p256dh&&b.p256dh.length>0&&"string"==typeof b.endpoint&&b.endpoint.length>0&&"string"==typeof b.swScope&&b.swScope.length>0&&"string"==typeof b.vapidKey&&b.vapidKey.length>0}(b)?null:b}let ac="firebase-messaging-store",ad=null;function ae(){return ad||(ad=(0,i.openDB)("firebase-messaging-database",1,{upgrade:(a,b)=>{0===b&&a.createObjectStore(ac)}})),ad}async function af(a){let b=function({appConfig:a}){return a.appId}(a),c=await ae(),d=await c.transaction(ac).objectStore(ac).get(b);if(d)return d;{let b=await ab(a.appConfig.senderId);if(b)return await ag(a,b),b}}async function ag(a,b){let c=function({appConfig:a}){return a.appId}(a),d=(await ae()).transaction(ac,"readwrite");return await d.objectStore(ac).put(b,c),await d.done,b}let ah=new h.ErrorFactory("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});async function ai(a,b){let c,d={method:"POST",headers:await am(a),body:JSON.stringify(an(b))};try{let b=await fetch(al(a.appConfig),d);c=await b.json()}catch(a){throw ah.create("token-subscribe-failed",{errorInfo:a?.toString()})}if(c.error){let a=c.error.message;throw ah.create("token-subscribe-failed",{errorInfo:a})}if(!c.token)throw ah.create("token-subscribe-no-token");return c.token}async function aj(a,b){let c,d={method:"PATCH",headers:await am(a),body:JSON.stringify(an(b.subscriptionOptions))};try{let e=await fetch(`${al(a.appConfig)}/${b.token}`,d);c=await e.json()}catch(a){throw ah.create("token-update-failed",{errorInfo:a?.toString()})}if(c.error){let a=c.error.message;throw ah.create("token-update-failed",{errorInfo:a})}if(!c.token)throw ah.create("token-update-no-token");return c.token}async function ak(a,b){let c=await am(a);try{let d=await fetch(`${al(a.appConfig)}/${b}`,{method:"DELETE",headers:c}),e=await d.json();if(e.error){let a=e.error.message;throw ah.create("token-unsubscribe-failed",{errorInfo:a})}}catch(a){throw ah.create("token-unsubscribe-failed",{errorInfo:a?.toString()})}}function al({projectId:a}){return`https://fcmregistrations.googleapis.com/v1/projects/${a}/registrations`}async function am({appConfig:a,installations:b}){let c=await b.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":a.apiKey,"x-goog-firebase-installations-auth":`FIS ${c}`})}function an({p256dh:a,auth:b,endpoint:c,vapidKey:d}){let e={web:{endpoint:c,auth:b,p256dh:a}};return d!==Y&&(e.web.applicationPubKey=d),e}async function ao(a){var b,c;let d,e,f,g,h=await ar(a.swRegistration,a.vapidKey),i={vapidKey:a.vapidKey,swScope:a.swRegistration.scope,endpoint:h.endpoint,auth:$(h.getKey("auth")),p256dh:$(h.getKey("p256dh"))},j=await af(a.firebaseDependencies);if(!j)return aq(a.firebaseDependencies,i);if(b=j.subscriptionOptions,d=(c=i).vapidKey===b.vapidKey,e=c.endpoint===b.endpoint,f=c.auth===b.auth,g=c.p256dh===b.p256dh,d&&e&&f&&g)if(Date.now()>=j.createTime+6048e5)return ap(a,{token:j.token,createTime:Date.now(),subscriptionOptions:i});else return j.token;try{await ak(a.firebaseDependencies,j.token)}catch(a){console.warn(a)}return aq(a.firebaseDependencies,i)}async function ap(a,b){try{let c=await aj(a.firebaseDependencies,b),d={...b,token:c,createTime:Date.now()};return await ag(a.firebaseDependencies,d),c}catch(a){throw a}}async function aq(a,b){let c={token:await ai(a,b),createTime:Date.now(),subscriptionOptions:b};return await ag(a,c),c.token}async function ar(a,b){let c=await a.pushManager.getSubscription();return c||a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:function(a){let b="=".repeat((4-a.length%4)%4),c=atob((a+b).replace(/\-/g,"+").replace(/_/g,"/")),d=new Uint8Array(c.length);for(let a=0;a<c.length;++a)d[a]=c.charCodeAt(a);return d}(b)})}function as(a){var b,c;let d={from:a.from,collapseKey:a.collapse_key,messageId:a.fcmMessageId};return function(a,b){if(!b.notification)return;a.notification={};let c=b.notification.title;c&&(a.notification.title=c);let d=b.notification.body;d&&(a.notification.body=d);let e=b.notification.image;e&&(a.notification.image=e);let f=b.notification.icon;f&&(a.notification.icon=f)}(d,a),b=d,(c=a).data&&(b.data=c.data),function(a,b){if(!b.fcmOptions&&!b.notification?.click_action)return;a.fcmOptions={};let c=b.fcmOptions?.link??b.notification?.click_action;c&&(a.fcmOptions.link=c);let d=b.fcmOptions?.analytics_label;d&&(a.fcmOptions.analyticsLabel=d)}(d,a),d}var at="AzSCbw63g1R0nCw85jG8",au="Iaya3yLKwmgvh7cF0q4";let av=[];for(let a=0;a<at.length;a++)av.push(at.charAt(a)),a<au.length&&av.push(au.charAt(a));function aw(a){return ah.create("missing-app-config-values",{valueName:a})}av.join("");class ax{constructor(a,b,c){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const d=function(a){if(!a||!a.options)throw aw("App Configuration Object");if(!a.name)throw aw("App Name");let{options:b}=a;for(let a of["projectId","apiKey","appId","messagingSenderId"])if(!b[a])throw aw(a);return{appName:a.name,projectId:b.projectId,apiKey:b.apiKey,appId:b.appId,senderId:b.messagingSenderId}}(a);this.firebaseDependencies={app:a,appConfig:d,installations:b,analyticsProvider:c}}_delete(){return Promise.resolve()}}async function ay(a){try{a.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),a.swRegistration.update().catch(()=>{}),await az(a.swRegistration)}catch(a){throw ah.create("failed-service-worker-registration",{browserErrorMessage:a?.message})}}async function az(a){return new Promise((b,c)=>{let d=setTimeout(()=>c(Error("Service worker not registered after 10000 ms")),1e4),e=a.installing||a.waiting;a.active?(clearTimeout(d),b()):e?e.onstatechange=a=>{a.target?.state==="activated"&&(e.onstatechange=null,clearTimeout(d),b())}:(clearTimeout(d),c(Error("No incoming service worker found.")))})}async function aA(a,b){if(b||a.swRegistration||await ay(a),b||!a.swRegistration){if(!(b instanceof ServiceWorkerRegistration))throw ah.create("invalid-sw-registration");a.swRegistration=b}}async function aB(a,b){b?a.vapidKey=b:a.vapidKey||(a.vapidKey=Y)}async function aC(a,b){if(!navigator)throw ah.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw ah.create("permission-blocked");return await aB(a,b?.vapidKey),await aA(a,b?.serviceWorkerRegistration),ao(a)}async function aD(a,b,c){let d=function(a){switch(a){case e.NOTIFICATION_CLICKED:return"notification_open";case e.PUSH_RECEIVED:return"notification_foreground";default:throw Error()}}(b);(await a.firebaseDependencies.analyticsProvider.get()).logEvent(d,{message_id:c[Z],message_name:c["google.c.a.c_l"],message_time:c["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function aE(a,b){let c=b.data;if(!c.isFirebaseMessaging)return;a.onMessageHandler&&c.messageType===e.PUSH_RECEIVED&&("function"==typeof a.onMessageHandler?a.onMessageHandler(as(c)):a.onMessageHandler.next(as(c)));let d=c.data;"object"==typeof d&&d&&Z in d&&"1"===d["google.c.a.e"]&&await aD(a,c.messageType,d)}let aF="@firebase/messaging",aG="0.12.23";(0,f._registerComponent)(new g.Component("messaging",a=>{let b=new ax(a.getProvider("app").getImmediate(),a.getProvider("installations-internal").getImmediate(),a.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",a=>aE(b,a)),b},"PUBLIC")),(0,f._registerComponent)(new g.Component("messaging-internal",a=>{let b=a.getProvider("messaging").getImmediate();return{getToken:a=>aC(b,a)}},"PRIVATE")),(0,f.registerVersion)(aF,aG),(0,f.registerVersion)(aF,aG,"esm2020"),a.i(69387);var aH=a.i(60574),aI=a.i(25408);(0,aH.getFirestore)(aI.app);let aJ=async a=>{console.log("Firebase Messaging is not supported in this browser or environment.")};a.s(["onForegroundMessage",0,a=>{console.log("Cannot set up foreground message listener in this environment.")},"requestNotificationPermission",0,aJ],37093)}];

//# sourceMappingURL=src_utils_firebaseMessaging_ts_3db8cc6f._.js.map